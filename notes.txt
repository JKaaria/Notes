Function GetRecipientEmail(logicTable As Worksheet, value1 As Variant, value2 As Variant) As String
    Dim lastRow As Long
    Dim lastColumn As Long
    Dim emailColumn As Long
    Dim i As Long
    Dim j As Long

    ' Find the column containing email addresses
    lastRow = logicTable.Cells(1, logicTable.Columns.Count).End(xlToLeft).Column
    For j = 1 To lastRow
        If logicTable.Cells(1, j).Value = "Email" Then ' Change "Email" to the actual header in LogicTable
            emailColumn = j
            Exit For
        End If
    Next j

    ' Loop through rows in LogicTable to find matching values
    lastRow = logicTable.Cells(logicTable.Rows.Count, 1).End(xlUp).Row
    For i = 2 To lastRow
        If logicTable.Cells(i, 1).Value = value1 And logicTable.Cells(i, 2).Value = value2 Then
            ' Get the email address from the corresponding column
            GetRecipientEmail = logicTable.Cells(i, emailColumn).Value
            Exit Function
        End If
    Next i
End Function
