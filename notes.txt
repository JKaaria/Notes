Sub AnalyzeRatings()
    Dim wsAllOfferings As Worksheet
    Dim wsOverview As Worksheet
    Dim lastRow As Long
    Dim meanClientRegType As Double
    Dim totalSP As Double
    Dim totalMoody As Double
    Dim totalFitch As Double
    Dim avgClientRegType As Double
    Dim avgSPRating As Double
    Dim avgMoodyRating As Double
    Dim avgFitchRating As Double
    
    ' Set references to worksheets
    Set wsAllOfferings = ThisWorkbook.Sheets("All Offerings")
    Set wsOverview = ThisWorkbook.Sheets("Overview")
    
    ' Find the last row with data in the All Offerings sheet
    lastRow = wsAllOfferings.Cells(wsAllOfferings.Rows.Count, "A").End(xlUp).Row
    
    ' Initialize means and totals
    meanClientRegType = 0
    totalSP = 0
    totalMoody = 0
    totalFitch = 0
    
    ' Loop through data in All Offerings sheet
    For i = 2 To lastRow ' Assuming headers are in the first row
        ' Check if the cell value is numeric before adding to mean
        If IsNumeric(wsAllOfferings.Cells(i, 8).Value) Then
            meanClientRegType = meanClientRegType + CDbl(wsAllOfferings.Cells(i, 8).Value) ' Column H
        Else
            ' Handle the case where the cell value is not numeric (e.g., non-numeric text)
            ' You can choose to ignore, display a message, or take appropriate action
            MsgBox "Non-numeric value found in Client Reg Type at row " & i
        End If
        
        ' Sum up values for mean
        totalSP = totalSP + wsAllOfferings.Cells(i, 9) ' Column I
        totalMoody = totalMoody + wsAllOfferings.Cells(i, 10) ' Column J
        totalFitch = totalFitch + wsAllOfferings.Cells(i, 11) ' Column K
    Next i
    
    ' Calculate means
    meanClientRegType = meanClientRegType / (lastRow - 1) ' Exclude header row
    avgSPRating = totalSP / (lastRow - 1)
    avgMoodyRating = totalMoody / (lastRow - 1)
    avgFitchRating = totalFitch / (lastRow - 1)
    
    ' Update Overview sheet with means
    wsOverview.Cells(2, 9).Value = meanClientRegType ' Column I (Mean Reg Type)
    wsOverview.Cells(2, 10).Value = avgSPRating ' Column J
    wsOverview.Cells(2, 11).Value = avgMoodyRating ' Column K
    wsOverview.Cells(2, 12).Value = avgFitchRating ' Column L
End Sub
