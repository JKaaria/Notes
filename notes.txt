Sub Seven()
    ' Define variables
    Dim wResult As Worksheet
    Dim lastRowResult As Long
    Dim outlookApp As Object
    Dim outlookMail As Object
    Dim emailBody As String

    ' Set worksheet
    Set wResult = ThisWorkbook.Sheets("ResultSheet") ' Replace "ResultSheet" with your actual sheet name

    ' Find the last row in ResultSheet
    lastRowResult = wResult.Cells(wResult.Rows.Count, 1).End(xlUp).Row

    ' Apply the formula in column I to check if D and E are mismatched
    wResult.Columns("I:I").Formula = "=IF(D2=E2,0,1)"

    ' Initialize email body
    emailBody = "Mismatching Entities Details:" & vbCrLf & vbCrLf

    ' Loop through the rows in ResultSheet to check for matching entities
    For i = 2 To lastRowResult
        If wResult.Cells(i, 9).Value = 1 Then ' Check the value in column I for mismatch (1 indicates a mismatch)
            ' Add details of mismatching row to email body
            emailBody = emailBody & "Row " & i & ": Entities do not match." & vbCrLf &
                         "SDS: " & wResult.Cells(i, 1).Value & vbCrLf &
                         "Account Legal Name: " & wResult.Cells(i, 2).Value & vbCrLf &
                         "Trade ID: " & wResult.Cells(i, 3).Value & vbCrLf &
                         "Trade Data Entity: " & wResult.Cells(i, 4).Value & vbCrLf &
                         "Logic Table Entity: " & wResult.Cells(i, 5).Value & vbCrLf &
                         "Quantity: " & wResult.Cells(i, 6).Value & vbCrLf &
                         "Security Description: " & wResult.Cells(i, 7).Value & vbCrLf &
                         "Settle Date: " & wResult.Cells(i, 8).Value & vbCrLf & vbCrLf
        End If
    Next i

    ' Create Outlook Application
    Set outlookApp = CreateObject("Outlook.Application")

    ' Create a new mail item
    Set outlookMail = outlookApp.CreateItem(0)

    ' Customize email properties
    With outlookMail
        .Subject = "T+0 UST Entity Matches - Regulatory/Financial Impact"
        .Body = emailBody & "Please wash today as per Logic Table Entity Stated."
        
        ' Add recipients' email addresses
        .Recipients.Add "xratcubondprocessing@barclays.com"
        .Recipients.Add "usratescashtatcu@barclays.com"

        ' Display the email
        .Display
    End With

    ' Release Outlook objects
    Set outlookMail = Nothing
    Set outlookApp = Nothing
End Sub