Sub SplitTextToColumnsAndAlign()
    Dim lastRow As Long
    Dim lastCol As Long
    Dim dataRange As Range
    Dim currentRow As Long
    Dim colCount As Long
    Dim cellValue As String
    Dim commaCount As Long
    Dim targetCommaCount As Long
    
    ' Find the last row and column with data
    lastRow = ActiveSheet.Cells(ActiveSheet.Rows.Count, 1).End(xlUp).Row
    lastCol = ActiveSheet.Cells(1, ActiveSheet.Columns.Count).End(xlToLeft).Column
    
    ' Set the data range
    Set dataRange = ActiveSheet.Range(ActiveSheet.Cells(1, 1), ActiveSheet.Cells(lastRow, lastCol))
    
    ' Iterate through each row starting from the second row (assuming the first row contains headers)
    For currentRow = 2 To lastRow
        ' Get the cell value in the first column of the current row
        cellValue = ActiveSheet.Cells(currentRow, 1).Value
        
        ' Count the number of commas in the cell value
        commaCount = Len(cellValue) - Len(Replace(cellValue, ",", ""))
        
        ' Determine the target number of commas based on the number of columns
        targetCommaCount = lastCol - 1 ' Assuming the first column is not part of the TextToColumns operation
        
        ' Add or delete commas to match the target number
        If commaCount < targetCommaCount Then
            ' Add commas
            Do While commaCount < targetCommaCount
                cellValue = cellValue & ","
                commaCount = commaCount + 1
            Loop
        ElseIf commaCount > targetCommaCount Then
            ' Delete commas
            Do While commaCount > targetCommaCount
                cellValue = Left(cellValue, InStrRev(cellValue, ",") - 1) & Mid(cellValue, InStrRev(cellValue, ",") + 1)
                commaCount = commaCount - 1
            Loop
        End If
        
        ' Set the modified cell value back to the cell
        ActiveSheet.Cells(currentRow, 1).Value = cellValue
    Next currentRow
    
    ' Use TextToColumns to split the data based on commas
    dataRange.TextToColumns Destination:=Range("A1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _
        Semicolon:=False, Comma:=True, Space:=False, Other:=False
        
    MsgBox "Text split to columns and aligned successfully!", vbInformation
End Sub
