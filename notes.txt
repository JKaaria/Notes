Sub Four()
    Dim outlookApp As Object
    Dim outlookMail As Object
    Dim emailBody As String
    Dim wResults As Worksheet
    Dim cell As Range
    Dim isBCINLNBR As Boolean

    ' Set workbook and ResultsSheet
    Set wsWorkbook = ThisWorkbook
    On Error Resume Next
    Set wResults = wsWorkbook.Sheets("ResultsSheet")
    On Error GoTo 0
    
    ' Check if ResultsSheet exists
    If wResults Is Nothing Then
        ' If ResultsSheet doesn't exist, create it
        Set wResults = wsWorkbook.Sheets.Add(After:=Sheets(Sheets.Count))
        wResults.Name = "ResultsSheet"
    End If

    ' Concatenate the contents of ResultsSheet to emailBody
    For Each cell In wResults.UsedRange
        ' Check if the cell is from BCIN or LNBR
        isBCINLNBR = (InStr(1, cell.Value, "Trade Data Entity:") > 0)
        
        ' If it's from BCIN or LNBR, add a line break for better separation
        If isBCINLNBR Then
            emailBody = emailBody & vbCrLf
        End If
        
        ' Add the cell value to emailBody
        emailBody = emailBody & cell.Value & vbCrLf
    Next cell

    ' Clear contents of column A
    Columns("A:A").Select
    Selection.ClearContents
    
    ' Set cell A1 with the formula
    Range("A1").Select
    ActiveCell.FormulaR1C1 = "MO Action Required"
    
    ' AutoFit the entire column
    Cells.EntireColumn.AutoFit
    
    ' Create Outlook Application
    On Error Resume Next
    Set outlookApp = GetObject(, "Outlook.Application")
    On Error GoTo 0
    
    If outlookApp Is Nothing Then
        Set outlookApp = CreateObject("Outlook.Application")
    End If
    
    ' Create a new mail item
    Set outlookMail = outlookApp.CreateItem(0)
    
    ' Customize email properties
    With outlookMail
        .To = "usfailsmanagement@barclayscorp.com"
        .CC = "ukratessalessupport@barclays.com"
        .Subject = "LDN UST DKs - PIs MO Action Points"
        .Body = "Please find the details below:" & vbCrLf & vbCrLf & emailBody
        ' Uncomment the line below if you want to display the email before sending
        '.Display
        ' Comment out the line above and uncomment the line below to send the email directly
        '.Send
    End With
    
    ' Release Outlook objects
    Set outlookMail = Nothing
    Set outlookApp = Nothing

    ' Delete ResultsSheet
    Application.DisplayAlerts = False
    On Error Resume Next
    wResults.Delete
    On Error GoTo 0
    Application.DisplayAlerts = True
End Sub

