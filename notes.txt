Sub SendEmailToContact()

    ' Define variables
    Dim wResults As Worksheet
    Dim wLogic As Worksheet
    Dim counterpartyHeader As Range
    Dim contact As Variant
    Dim tradeDetailsRange As Range
    Dim tradeDetails As String
    Dim outlookApp As Object
    Dim outlookMail As Object
    
    ' Set worksheets
    Set wResults = ThisWorkbook.Sheets("ResultsSheet")
    Set wLogic = ThisWorkbook.Sheets("LogicTable")
    
    ' Find "Counterparty" column header in "ResultsSheet"
    On Error Resume Next
    Set counterpartyHeader = wResults.Rows(1).Find("Counterparty", LookIn:=xlValues)
    On Error GoTo 0
    
    ' Check if header is found
    If Not counterpartyHeader Is Nothing Then
        ' Find contact in "LogicTable"
        contact = Application.WorksheetFunction.VLookup(wResults.Cells(2, counterpartyHeader.Column).Value, wLogic.Range("A:E"), 5, False)
        
        ' Check if contact is found
        If Not IsError(contact) Then
            ' Set range for trade details
            Set tradeDetailsRange = wResults.Range("A2:I2") ' Adjust as needed
            
            ' Create trade details string
            tradeDetails = "Account Legal Name: " & tradeDetailsRange.Cells(1, 1).Value & vbCrLf & _
                           "Settle Legal Entity: " & tradeDetailsRange.Cells(1, 2).Value & vbCrLf & _
                           "Trade ID: " & tradeDetailsRange.Cells(1, 3).Value & vbCrLf & _
                           "BARC Direction: " & tradeDetailsRange.Cells(1, 4).Value & vbCrLf & _
                           "Quantity: " & tradeDetailsRange.Cells(1, 5).Value & vbCrLf & _
                           "Security Description: " & tradeDetailsRange.Cells(1, 6).Value & vbCrLf & _
                           "Clean Price: " & tradeDetailsRange.Cells(1, 7).Value & vbCrLf & _
                           "Settle Date: " & tradeDetailsRange.Cells(1, 8).Value & vbCrLf & _
                           "Mat Date: " & tradeDetailsRange.Cells(1, 9).Value
            
            ' Create Outlook Application
            Set outlookApp = CreateObject("Outlook.Application")
            
            ' Create a new mail item
            Set outlookMail = outlookApp.CreateItem(0)
            
            ' Set email properties
            With outlookMail
                .To = contact
                .Subject = "Trade Details"
                .Body = tradeDetails
                ' Uncomment the next line to send the email
                '.Send
            End With
            
            ' Display a message (you can modify this part as needed)
            MsgBox "Email sent to: " & contact, vbInformation
        Else
            MsgBox "Contact not found in LogicTable!", vbExclamation
        End If
    Else
        MsgBox "Column header 'Counterparty' not found in ResultsSheet!", vbExclamation
    End If

End Sub
