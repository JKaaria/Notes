Sub FilterAndCopySalesPersons()

    ' Define variables
    Dim wsTrade As Worksheet
    Dim wsNewSheet As Worksheet
    Dim lastRowTrade As Long
    Dim salesPersonCol As Integer
    Dim filterNames As Variant
    Dim cellValue As String
    Dim i As Long, j As Long
    
    ' Set worksheets
    Set wsTrade = ThisWorkbook.Sheets("TradeData") ' Replace "TradeData" with the actual name of your trade data sheet
    ' Add a new sheet for filtered data
    Set wsNewSheet = Sheets.Add(After:=Sheets(Sheets.Count))
    wsNewSheet.Name = "RepoSales-Cash Trades"
    
    ' Set column number based on header
    salesPersonCol = WorksheetFunction.Match("Sales Person", wsTrade.Rows(1), 0)
    
    ' Find the last row in the sheet
    lastRowTrade = wsTrade.Cells(wsTrade.Rows.Count, salesPersonCol).End(xlUp).Row
    
    ' Array of filter names
    filterNames = Array("Aujeet, Devi", "Skingle, David", "Leal, Rui", "Laosun, Michael", "Haskins, Justin", _
                        "Yohannes, Ksanet", "Pattni, Shahil", "Ruparelia, Malvi", "Rodriguez, Edgar")
    
    ' Copy headers to the new sheet
    wsTrade.Rows(1).Copy wsNewSheet.Rows(1)
    
    ' Loop through "Sales Person" column
    For i = 2 To lastRowTrade
        cellValue = UCase(Trim(wsTrade.Cells(i, salesPersonCol).Value))
        ' Check if the cell value matches any filter names
        For j = LBound(filterNames) To UBound(filterNames)
            If InStr(1, cellValue, UCase(filterNames(j))) > 0 Then
                ' If match, copy the entire row to the new sheet
                wsTrade.Rows(i).Copy wsNewSheet.Cells(wsNewSheet.Cells(wsNewSheet.Rows.Count, 1).End(xlUp).Row + 1, 1)
                Exit For ' Exit inner loop after matching
            End If
        Next j
    Next i
    
    MsgBox "Filtering and copying complete!", vbInformation

End Sub

