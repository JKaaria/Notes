Sub AnalyzeRatings()
    Dim wsAllOfferings As Worksheet
    Dim wsOverview As Worksheet
    Dim lastRow As Long
    Dim totalClients As Double
    Dim totalSP As Double
    Dim totalMoody As Double
    Dim totalFitch As Double
    Dim avgClientRegType As Double
    Dim avgSPRating As Double
    Dim avgMoodyRating As Double
    Dim avgFitchRating As Double
    
    ' Set references to worksheets
    Set wsAllOfferings = ThisWorkbook.Sheets("All Offerings")
    Set wsOverview = ThisWorkbook.Sheets("Overview")
    
    ' Find the last row with data in the All Offerings sheet
    lastRow = wsAllOfferings.Cells(wsAllOfferings.Rows.Count, "A").End(xlUp).Row
    
    ' Initialize totals
    totalClients = 0
    totalSP = 0
    totalMoody = 0
    totalFitch = 0
    
    ' Loop through data in All Offerings sheet
    For i = 2 To lastRow ' Assuming headers are in the first row
        ' Sum up values for averaging
        totalClients = totalClients + wsAllOfferings.Cells(i, 8) ' Column H (reg type)
        totalSP = totalSP + wsAllOfferings.Cells(i, 9) ' Column I (S&P)
        totalMoody = totalMoody + wsAllOfferings.Cells(i, 10) ' Column J (Moody)
        totalFitch = totalFitch + wsAllOfferings.Cells(i, 11) ' Column K (Fitch)
    Next i
    
    ' Calculate averages
    avgClientRegType = totalClients / (lastRow - 1) ' Exclude header row
    avgSPRating = totalSP / (lastRow - 1)
    avgMoodyRating = totalMoody / (lastRow - 1)
    avgFitchRating = totalFitch / (lastRow - 1)
    
    ' Update Overview sheet with averages
    wsOverview.Cells(2, 9).Value = avgClientRegType ' Column I
    wsOverview.Cells(2, 10).Value = avgSPRating ' Column J
    wsOverview.Cells(2, 11).Value = avgMoodyRating ' Column K
    wsOverview.Cells(2, 12).Value = avgFitchRating ' Column L
End Sub
