' Loop through each row in the TradeData sheet
For i = 2 To lastRowTrade
    ' Check if Counterparty ID is found in LogicTable sheet
    If Not IsEmpty(wsTrade.Cells(i, counterpartyIDCol.Column).Value) Then
        If WorksheetFunction.CountIf(wsLogic.Columns(logicCounterpartyCol.Column), wsTrade.Cells(i, counterpartyIDCol.Column).Value) > 0 Then
            ' Check if Settle Legal Entity matches
            Dim logicRowIndex As Long
            logicRowIndex = Application.Match(wsTrade.Cells(i, counterpartyIDCol.Column).Value, wsLogic.Columns(logicCounterpartyCol.Column), 0)
            
            If wsTrade.Cells(i, settleLegalEntityCol.Column).Value <> wsLogic.Cells(logicRowIndex, wsLogic.Rows(1).Find("Settle Legal Entity", LookIn:=xlValues, LookAt:=xlWhole).Column).Value Then
                ' Add details of mismatching row to email body
                emailBody = emailBody & "Row " & i & ": Mismatched Settle Legal Entity." & vbCrLf & _
                             "Counterparty ID: " & wsTrade.Cells(i, counterpartyIDCol.Column).Value & vbCrLf & _
                             "Settle Legal Entity (TradeData): " & wsTrade.Cells(i, settleLegalEntityCol.Column).Value & vbCrLf & _
                             "Settle Legal Entity (LogicTable): " & wsLogic.Cells(logicRowIndex, wsLogic.Rows(1).Find("Settle Legal Entity", LookIn:=xlValues, LookAt:=xlWhole).Column).Value & vbCrLf & vbCrLf
            End If
        End If
    End If
Next i