Sub CopyMatchingRows()
    Dim sheet1 As Worksheet, sheet2 As Worksheet, resultsSheet As Worksheet
    Dim lastRow1 As Long, lastRow2 As Long, resultsRow As Long
    Dim valueToMatch As Variant
    
    ' Set your sheet names here
    Set sheet1 = ThisWorkbook.Sheets("Sheet1")
    Set sheet2 = ThisWorkbook.Sheets("Sheet2")
    
    ' Create a new sheet for results
    Set resultsSheet = ThisWorkbook.Sheets.Add(After:=Sheets(Sheets.Count))
    resultsSheet.Name = "ResultsSheet"
    
    ' Find the last rows in both sheets
    lastRow1 = sheet1.Cells(sheet1.Rows.Count, "B").End(xlUp).Row
    lastRow2 = sheet2.Cells(sheet2.Rows.Count, "B").End(xlUp).Row
    
    ' Initialize the row for results
    resultsRow = 1
    
    ' Loop through rows in sheet1
    For i = 1 To lastRow1
        ' Get the value to match from column B of sheet1
        valueToMatch = sheet1.Cells(i, "B").Value
        
        ' Check if the value exists in column B of sheet2
        If WorksheetFunction.CountIf(sheet2.Range("B1:B" & lastRow2), valueToMatch) > 0 Then
            ' Copy the entire row from sheet1 to resultsSheet
            sheet1.Rows(i).Copy resultsSheet.Rows(resultsRow)
            resultsRow = resultsRow + 1
        End If
    Next i
    
    MsgBox "Matching rows copied to ResultsSheet!", vbInformation
End Sub
