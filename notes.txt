Sub EmailWithTable()
    Dim outlookApp As Object
    Dim outlookMail As Object
    Dim bodyText As String
    Dim ws As Worksheet
    
    ' Set the active worksheet
    Set ws = ActiveSheet

    ' Create Outlook Application
    On Error Resume Next
    Set outlookApp = GetObject(, "Outlook.Application")
    On Error GoTo 0

    If outlookApp Is Nothing Then
        Set outlookApp = CreateObject("Outlook.Application")
    End If

    ' Create a new mail item
    Set outlookMail = outlookApp.CreateItem(0)

    ' Customize email properties
    With outlookMail
        .To = "recipient@example.com" ' Change to the actual recipient's email address
        .Subject = ws.Range("O1").Value ' Set subject to the contents of cell O1
        
        ' Construct the email body with selected columns in table format
        bodyText = "<html><body><p>Here are the selected columns:</p><table border='1' style='border-collapse: collapse;'>"

        ' Loop through each row in the worksheet
        For i = 2 To ws.Cells(ws.Rows.Count, 1).End(xlUp).Row ' Assuming headers are in row 1
            ' Append selected columns to the email body as a table row
            bodyText = bodyText & "<tr><td>" & ws.Cells(i, 1).Value & "</td><td>" & ws.Cells(i, 2).Value & "</td><td>" & ws.Cells(i, 6).Value & "</td></tr>"
        Next i

        ' Close the table and body tags
        bodyText = bodyText & "</table></body></html>"

        ' Set the email body as HTML
        .HTMLBody = bodyText

        ' Uncomment the line below if you want to display the email before sending
        '.Display

        ' Comment out the line above and uncomment the line below to send the email directly
        '.Send
    End With

    ' Release Outlook objects
    Set outlookMail = Nothing
    Set outlookApp = Nothing
End Sub