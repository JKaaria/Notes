Sub SendExceptionEmail(exceptionList As String)
    Dim outlookApp As Object
    Dim outlookMail As Object
    Dim olRecipient As Object

    ' Create Outlook Application
    Set outlookApp = CreateObject("Outlook.Application")
    Set outlookMail = outlookApp.CreateItem(0)

    ' Set email properties
    With outlookMail
        .To = "recipient@example.com" ' Replace with the recipient's email address
        .Subject = "Trade Data Exceptions"
        .Body = "The following exceptions were found in the Trade Data:" & vbCrLf & vbCrLf & exceptionList
        .Display ' Display email for review before sending

        ' Set "Send on Behalf Of" property using late binding
        Set olRecipient = .Recipients.Add("FI_Allocations@barclays.com")
        olRecipient.Type = 2 ' olSendOnBehalf

        ' Uncomment the next line to automatically send the email
        '.Send
    End With

    ' Clean up
    Set outlookMail = Nothing
    Set outlookApp = Nothing
End Sub

