Sub SplitTextToColumnsAndAlign()
    Dim lastRow As Long
    Dim lastCol As Long
    Dim currentCol As Long
    Dim currentRow As Long
    Dim targetCommaCount As Long
    Dim cellValue As String
    Dim commaCount As Long
    
    ' Find the last row and column with data
    lastRow = ActiveSheet.Cells(ActiveSheet.Rows.Count, 1).End(xlUp).Row
    lastCol = ActiveSheet.Cells(1, ActiveSheet.Columns.Count).End(xlToLeft).Column
    
    ' Iterate through each column starting from the second column (assuming the first column is not part of the TextToColumns operation)
    For currentCol = 2 To lastCol
        ' Iterate through each row in the current column
        For currentRow = 1 To lastRow
            ' Get the cell value in the current cell
            cellValue = ActiveSheet.Cells(currentRow, currentCol).Value
            
            ' Count the number of commas in the cell value
            commaCount = Len(cellValue) - Len(Replace(cellValue, ",", ""))
            
            ' Determine the target number of commas based on the number of columns
            targetCommaCount = 1 ' Assuming each column should have one comma
            
            ' Add or delete commas to match the target number
            If commaCount < targetCommaCount Then
                ' Add commas
                Do While commaCount < targetCommaCount
                    cellValue = cellValue & ","
                    commaCount = commaCount + 1
                Loop
            ElseIf commaCount > targetCommaCount Then
                ' Delete commas
                Do While commaCount > targetCommaCount
                    cellValue = Left(cellValue, InStrRev(cellValue, ",") - 1) & Mid(cellValue, InStrRev(cellValue, ",") + 1)
                    commaCount = commaCount - 1
                Loop
            End If
            
            ' Set the modified cell value back to the cell
            ActiveSheet.Cells(currentRow, currentCol).Value = cellValue
        Next currentRow
    Next currentCol
    
    ' Use TextToColumns to split the data based on commas in each column
    For currentCol = 2 To lastCol
        ActiveSheet.Columns(currentCol).TextToColumns Destination:=ActiveSheet.Cells(1, currentCol), DataType:=xlDelimited, _
            TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _
            Semicolon:=False, Comma:=True, Space:=False, Other:=False
    Next currentCol
    
    MsgBox "Text split to columns and aligned successfully!", vbInformation
End Sub
