Sub FilterAndDelete()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim filterRange As Range
    Dim cell As Range
    
    ' Set the worksheet
    Set ws = ThisWorkbook.Sheets("TradeData") ' Change "TradeData" to your actual sheet name
    
    ' Find the last row in column AW
    lastRow = ws.Cells(ws.Rows.Count, "AW").End(xlUp).Row
    
    ' Set the filter range
    Set filterRange = ws.Range("AW1:AW" & lastRow)
    
    ' Apply the filter for entries beginning with "US912"
    filterRange.AutoFilter Field:=1, Criteria1:="<>US912*", Operator:=xlFilterValues
    
    ' Loop through each visible cell in the filtered range in reverse order
    For i = lastRow To 2 Step -1
        If ws.Rows(i).EntireRow.Hidden Then
            ' If the row is hidden (doesn't start with "US912"), delete the entire row
            ws.Rows(i).EntireRow.Delete
        End If
    Next i
    
    ' Turn off the AutoFilter
    ws.AutoFilterMode = False
End Sub
