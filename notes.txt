
Sub DeleteRowsByFailCode()
    Dim ws As Worksheet
    Dim failCodeColumn As Range
    Dim lastRow As Long
    Dim i As Long

    ' Set the worksheet variable
    Set ws = ThisWorkbook.Sheets("AFT")

    ' Find the header row and locate the "Fail Code" column
    On Error Resume Next
    Set failCodeColumn = ws.Rows(1).Find(What:="Fail Code", LookIn:=xlValues, LookAt:=xlWhole)
    On Error GoTo 0

    ' Check if the "Fail Code" column is found
    If Not failCodeColumn Is Nothing Then
        ' Find the last row in the "Fail Code" column
        lastRow = ws.Cells(ws.Rows.Count, failCodeColumn.Column).End(xlUp).Row

        ' Loop through each row in the "Fail Code" column
        For i = lastRow To 2 Step -1 ' Loop in reverse to avoid issues with deleting rows
            ' Check if the Fail Code is 102, 133, 121, or 30
            Select Case ws.Cells(i, failCodeColumn.Column).Value
                Case 102, 133, 121, 30
                    ' Delete the entire row
                    ws.Rows(i).Delete
            End Select
        Next i
    Else
        MsgBox "Column 'Fail Code' not found in the worksheet."
    End If
End Sub
