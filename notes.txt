Sub AverageDiscount(wsOverview As Worksheet, wsOfferings As Worksheet, sector As Variant)
    Dim lastRow As Long
    Dim totalDiscount As Double
    Dim discountCount As Long
    Dim averageDiscount As Double
    Dim i As Long
    
    ' Find the last row in the Offerings sheet
    lastRow = wsOfferings.Cells(wsOfferings.Rows.Count, "X").End(xlUp).Row
    
    ' Initialize variables
    totalDiscount = 0
    discountCount = 0
    
    ' Loop through each row in the Offerings sheet
    For i = 2 To lastRow ' Assuming row 1 contains headers
        ' Check if the current row belongs to the specified sector
        If wsOfferings.Cells(i, "X").Value = sector Then
            ' Accumulate discounts
            totalDiscount = totalDiscount + wsOfferings.Cells(i, "C").Value
            ' Increment discount count
            discountCount = discountCount + 1
        End If
    Next i
    
    ' Calculate average discount (avoid division by zero)
    If discountCount > 0 Then
        averageDiscount = totalDiscount / discountCount
    Else
        averageDiscount = 0
    End If
    
    ' Write result to Overview sheet
    wsOverview.Cells(wsOverview.Rows.Count, "D").End(xlUp).Offset(1, 0).Value = sector
    wsOverview.Cells(wsOverview.Rows.Count, "F").End(xlUp).Offset(1, 0).Value = averageDiscount
End Sub

Sub AverageDTM(wsOverview As Worksheet, wsOfferings As Worksheet, sector As Variant)
    Dim lastRow As Long
    Dim totalDTM As Double
    Dim dtmCount As Long
    Dim averageDTM As Double
    Dim i As Long
    
    ' Find the last row in the Offerings sheet
    lastRow = wsOfferings.Cells(wsOfferings.Rows.Count, "X").End(xlUp).Row
    
    ' Initialize variables
    totalDTM = 0
    dtmCount = 0
    
    ' Loop through each row in the Offerings sheet
    For i = 2 To lastRow ' Assuming row 1 contains headers
        ' Check if the current row belongs to the specified sector
        If wsOfferings.Cells(i, "X").Value = sector Then
            ' Accumulate DTM
            totalDTM = totalDTM + wsOfferings.Cells(i, "D").Value
            ' Increment DTM count
            dtmCount = dtmCount + 1
        End If
    Next i
    
    ' Calculate average DTM (avoid division by zero)
    If dtmCount > 0 Then
        averageDTM = totalDTM / dtmCount
    Else
        averageDTM = 0
    End If
    
    ' Write result to Overview sheet
    wsOverview.Cells(wsOverview.Rows.Count, "D").End(xlUp).Offset(1, 0).Value = sector
    wsOverview.Cells(wsOverview.Rows.Count, "G").End(xlUp).Offset(1, 0).Value = averageDTM
End Sub

Sub SecurityTypeDistribution(wsOverview As Worksheet, wsOfferings As Worksheet, sector As Variant)
    Dim lastRow As Long
    Dim securityTypeCounts As Collection
    Dim securityType As Variant
    Dim i As Long
    
    ' Find the last row in the Offerings sheet
    lastRow = wsOfferings.Cells(wsOfferings.Rows.Count, "X").End(xlUp).Row
    
    ' Create a collection to store security type counts
    Set securityTypeCounts = New Collection
    
    ' Loop through each row in the Offerings sheet
    For i = 2 To lastRow ' Assuming row 1 contains headers
        ' Check if the current row belongs to the specified sector
        If wsOfferings.Cells(i, "X").Value = sector Then
            ' Count security types
            On Error Resume Next
            securityTypeCounts.Add 1, CStr(wsOfferings.Cells(i, "L").Value)
            On Error GoTo 0
        End If
    Next i
    
    ' Write security type distribution to Overview sheet
    wsOverview.Cells(wsOverview.Rows.Count, "D").End(xlUp).Offset(1, 0).Value = sector
    For Each securityType In securityTypeCounts
        wsOverview.Cells(wsOverview.Rows.Count, Columns.Count).End(xlToLeft).Offset(0, 1).Value = securityType
        wsOverview.Cells(wsOverview.Rows.Count, Columns.Count).End(xlToLeft).Offset(1, 0).Value = securityTypeCounts(securityType)
    Next securityType
End Sub

' Add more subroutines for other metrics...
