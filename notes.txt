Function GetRecipientEmail(logicTable As Worksheet, value1 As Variant, value2 As Variant) As String
    Dim lastRow As Long
    Dim foundRow As Range

    ' Find matching row based on values in LogicTable
    lastRow = logicTable.Cells(logicTable.Rows.Count, 1).End(xlUp).Row
    Set foundRow = logicTable.Range("A1:A" & lastRow).Find(What:=value1)

    ' Check if a match is found
    If Not foundRow Is Nothing Then
        ' Check if the corresponding cell in the same row matches value2
        If logicTable.Cells(foundRow.Row, 2).Value = value2 Then
            ' Return the email address from column C
            GetRecipientEmail = logicTable.Cells(foundRow.Row, 3).Value
            Exit Function
        End If
    End If
    
    ' Return an empty string if no match is found
    GetRecipientEmail = ""
End Function
