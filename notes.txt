
Sub AppendToConsolidatedWorkbook()
    Dim SourceFolderPath As String
    Dim ConsolidatedWorkbookPath As String
    Dim ConsolidatedWorkbook As Workbook
    Dim SourceWorkbook As Workbook
    Dim SourceWorksheet As Worksheet
    Dim SourceFile As String
    Dim FirstFile As Boolean
    
    ' Set the source folder path
    SourceFolderPath = "C:\Your\Folder\Path" ' Replace with your folder path
    
    ' Set the path to the consolidated workbook
    ConsolidatedWorkbookPath = ThisWorkbook.Path & "\ConsolidatedWorkbook.xlsm"
    
    ' Check if the consolidated workbook exists
    If Dir(ConsolidatedWorkbookPath) = "" Then
        MsgBox "Consolidated workbook does not exist. Please create it first."
        Exit Sub
    End If
    
    ' Open the consolidated workbook
    Set ConsolidatedWorkbook = Workbooks.Open(ConsolidatedWorkbookPath)
    
    ' Initialize a variable to track if it's the first file
    FirstFile = True
    
    ' Loop through files in the folder
    SourceFile = Dir(SourceFolderPath & "\*.xls*")
    Do While SourceFile <> ""
        ' Open the source workbook
        Set SourceWorkbook = Workbooks.Open(SourceFolderPath & "\" & SourceFile)
        
        ' Loop through worksheets in the source workbook
        For Each SourceWorksheet In SourceWorkbook.Sheets
            ' Check if it's the first worksheet to set column headers
            If FirstFile Then
                SourceWorksheet.UsedRange.Copy Destination:=ConsolidatedWorkbook.Sheets(1).Cells(1, 1)
                FirstFile = False
            Else
                ' Copy data from column B onward to avoid duplicating column A
                SourceWorksheet.Range("B1").CurrentRegion.Offset(, 1).Copy Destination:=ConsolidatedWorkbook.Sheets(1).Cells(ConsolidatedWorkbook.Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row + 1, 2)
            End If
        Next SourceWorksheet
        
        ' Close the source workbook without saving changes
        SourceWorkbook.Close SaveChanges:=False
        
        ' Get the next file in the folder
        SourceFile = Dir
    Loop
    
    ' Save and close the consolidated workbook
    ConsolidatedWorkbook.Save
    ConsolidatedWorkbook.Close SaveChanges:=False
End Sub
