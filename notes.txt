Sub AnalyzeSectors()
    Dim wsAllOfferings As Worksheet
    Dim wsOverview As Worksheet
    Dim lastRow As Long
    Dim sector As String
    Dim uniqueSectors As Collection
    Dim totalDiscount As Double
    Dim totalCoupons As Double
    Dim offeringsCount As Integer
    Dim existingRow As Variant
    Dim newRow As Long
    Dim i As Long
    
    ' Set references to worksheets
    Set wsAllOfferings = ThisWorkbook.Sheets("All Offerings")
    Set wsOverview = ThisWorkbook.Sheets("Overview")
    
    ' Clear previous data in "Overview" sheet starting from cell D1
    wsOverview.Range("D1:G" & wsOverview.Rows.Count).Clear
    
    ' Set reference to unique sectors using Collection
    Set uniqueSectors = New Collection
    
    ' Find the last row in column A of "All Offerings" sheet
    lastRow = wsAllOfferings.Cells(wsAllOfferings.Rows.Count, "A").End(xlUp).Row
    
    ' Loop through each row in "All Offerings" sheet
    For i = 2 To lastRow ' Assuming headers are in the first row
        
        ' Get sector from column X (assuming X is the column number for "Sector")
        sector = wsAllOfferings.Cells(i, 24).Value
        
        ' Check if sector is not already in the collection
        On Error Resume Next
        uniqueSectors.Add sector, CStr(sector)
        On Error GoTo 0
        
        ' Update data for the sector
        totalDiscount = totalDiscount + wsAllOfferings.Cells(i, 3).Value ' Assuming column C is for "Price (Discount)"
        totalCoupons = totalCoupons + wsAllOfferings.Cells(i, 17).Value ' Assuming column Q is for "Coupon"
        offeringsCount = offeringsCount + 1
    Next i
    
    ' Populate data in "Overview" sheet starting from cell D1
    newRow = 1
    For i = 1 To uniqueSectors.Count
        sector = uniqueSectors(i)
        
        ' Update data for the sector
        wsOverview.Cells(newRow, 4).Value = sector
        wsOverview.Cells(newRow, 5).Value = totalDiscount / offeringsCount
        wsOverview.Cells(newRow, 6).Value = totalCoupons
        wsOverview.Cells(newRow, 7).Value = offeringsCount
        
        ' Move to the next row
        newRow = newRow + 1
    Next i
End Sub
