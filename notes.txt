Sub CheckAndDisplayEmail()
    Dim wsTradeData As Worksheet
    Dim wsT0WIBookings As Worksheet
    Dim lastRowTradeData As Long
    Dim tradeIDCol As Range
    Dim tradeIDColumnIndex As Long
    Dim cell As Range
    Dim tradeID As String
    Dim emailSubject As String
    Dim foundMatch As Boolean
    
    ' Set worksheets
    Set wsTradeData = ThisWorkbook.Sheets("TradeData")
    Set wsT0WIBookings = ThisWorkbook.Sheets("T+0 WI Bookings")
    
    ' Find the last row in the TradeData sheet
    lastRowTradeData = wsTradeData.Cells(wsTradeData.Rows.Count, 1).End(xlUp).Row
    
    ' Find the column index of the "Trade ID" column (assumes it's in the first row)
    tradeIDColumnIndex = 0
    For i = 1 To wsTradeData.Cells(1, wsTradeData.Columns.Count).End(xlToLeft).Column
        If wsTradeData.Cells(1, i).Value = "Trade ID" Then
            tradeIDColumnIndex = i
            Exit For
        End If
    Next i
    
    ' Check if "Trade ID" column was found
    If tradeIDColumnIndex = 0 Then
        MsgBox "The 'Trade ID' column was not found.", vbExclamation
        Exit Sub
    End If
    
    ' Set the range for the "Trade ID" column
    Set tradeIDCol = wsTradeData.Range(wsTradeData.Cells(2, tradeIDColumnIndex), wsTradeData.Cells(lastRowTradeData, tradeIDColumnIndex))
    
    ' Initialize variables
    foundMatch = False
    
    ' Loop through each cell in the "Trade ID" column
    For Each cell In tradeIDCol
        tradeID = cell.Value
        
        ' Check if the tradeID exists in T+0 WI Bookings sheet
        If WorksheetFunction.CountIf(wsT0WIBookings.Columns("A"), tradeID) > 0 Then
            ' If a match is found, set the flag and break the loop
            foundMatch = True
            Exit For
        End If
    Next cell
    
    ' Display email if a match is found
    If foundMatch Then
        emailSubject = "Trade ID: " & tradeID
        SendEmail emailSubject, ""
    Else
        MsgBox "No matching Trade ID found in T+0 WI Bookings.", vbInformation
    End If
End Sub

Sub SendEmail(subject As String, body As String)
    Dim outlookApp As Object
    Dim outlookMail As Object
    
    ' Create Outlook application
    Set outlookApp = CreateObject("Outlook.Application")
    
    ' Create a new mail item
    Set outlookMail = outlookApp.CreateItem(0)
    
    ' Set email properties
    With outlookMail
        .Subject = subject
        .Body = body
        .Display
    End With
    
    ' Clean up
    Set outlookMail = Nothing
    Set outlookApp = Nothing
End Sub

