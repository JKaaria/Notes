Add-Type @"
    using System;
    using System.Runtime.InteropServices;
    public class UserWindows {
        [DllImport("user32.dll")]
        public static extern IntPtr GetForegroundWindow();
        [DllImport("user32.dll")]
        public static extern int GetWindowText(IntPtr hWnd, System.Text.StringBuilder text, int count);
    }
"@

$foregroundWindow = [UserWindows]::GetForegroundWindow()
$windowTitle = New-Object -TypeName System.Text.StringBuilder 256
[UserWindows]::GetWindowText($foregroundWindow, $windowTitle, $windowTitle.Capacity) | Out-Null
$windowTitle.ToString()
