Sub SortTradeDataByDate()
    Dim ws As Worksheet
    Dim lastRow As Long
    
    ' Set the worksheet
    Set ws = ThisWorkbook.Sheets("TradeData")
    
    ' Find the last row with data in Column A
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' Convert the dates to strings in a helper column (e.g., Column B)
    ws.Range("B2:B" & lastRow).Formula = "=TEXT(A2,""DD/MM/YY"")"
    
    ' Sort the data based on the helper column (Column B)
    ws.Sort.SortFields.Clear
    ws.Sort.SortFields.Add Key:=ws.Range("B2:B" & lastRow), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
    With ws.Sort
        .SetRange ws.Range("A1").Resize(lastRow, 2) ' Adjust the range as needed
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
    ' Remove the helper column (Column B)
    ws.Range("B:B").Delete
    
    MsgBox "TradeData sheet has been sorted by Trade Date."
End Sub
