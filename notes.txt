Sub AnalyseRegulatoryTypes()
    Dim wsAllOfferings As Worksheet
    Dim wsOverview As Worksheet
    Dim lastRow As Long
    Dim uniqueRegTypes As Collection
    Dim regType As Variant
    Dim countRegType As Long
    Dim i As Long
    
    ' Set worksheets
    Set wsAllOfferings = ThisWorkbook.Sheets("All Offerings")
    Set wsOverview = ThisWorkbook.Sheets("Overview")
    
    ' Clear previous data in Overview sheet
    wsOverview.Range("I:J").Clear
    
    ' Find the last row in All Offerings sheet
    lastRow = wsAllOfferings.Cells(wsAllOfferings.Rows.Count, "A").End(xlUp).Row
    
    ' Initialize collections
    Set uniqueRegTypes = New Collection
    
    ' Loop through All Offerings sheet to gather unique regulatory types
    On Error Resume Next
    For i = 2 To lastRow ' Assuming headers are in row 1
        uniqueRegTypes.Add wsAllOfferings.Cells(i, "H").Value, CStr(wsAllOfferings.Cells(i, "H").Value)
    Next i
    On Error GoTo 0
    
    ' Write titles to the Overview sheet
    wsOverview.Cells(1, "I").Value = "Regulatory Type"
    wsOverview.Cells(1, "J").Value = "Count"
    
    ' Loop through unique regulatory types and count issuances
    For Each regType In uniqueRegTypes
        countRegType = 0
        
        For i = 2 To lastRow
            If CStr(wsAllOfferings.Cells(i, "H").Value) = regType Then
                countRegType = countRegType + 1
            End If
        Next i
        
        ' Write results to Overview sheet
        wsOverview.Cells(wsOverview.Rows.Count, "I").End(xlUp).Offset(1, 0).Value = regType
        wsOverview.Cells(wsOverview.Rows.Count, "J").End(xlUp).Offset(1, 0).Value = countRegType
    Next regType
End Sub
