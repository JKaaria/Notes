Sub CreateOverviewSheet()
    Dim wsAllOfferings As Worksheet
    Dim wsOverview As Worksheet
    Dim lastRow As Long

    ' Set references to sheets
    On Error Resume Next
    Set wsAllOfferings = ThisWorkbook.Sheets("All Offerings")
    On Error GoTo 0

    If wsAllOfferings Is Nothing Then
        MsgBox "Sheet 'All Offerings' not found!", vbExclamation
        Exit Sub
    End If

    ' Check if "Overview" sheet already exists, if yes, delete it
    On Error Resume Next
    Application.DisplayAlerts = False
    Set wsOverview = ThisWorkbook.Sheets("Overview")
    On Error GoTo 0
    Application.DisplayAlerts = True

    If Not wsOverview Is Nothing Then
        Application.DisplayAlerts = False
        wsOverview.Delete
        Application.DisplayAlerts = True
    End If

    ' Create a new sheet named "Overview"
    Set wsOverview = Sheets.Add(After:=Sheets(Sheets.Count))
    wsOverview.Name = "Overview"

    ' Find the last row in the "All Offerings" sheet
    lastRow = wsAllOfferings.Cells(wsAllOfferings.Rows.Count, "A").End(xlUp).Row

    ' Copy headers to the "Overview" sheet
    wsAllOfferings.Rows(1).Copy wsOverview.Rows(1)

    ' Add summary metrics
    wsOverview.Cells(2, 31).Value = "Total Offerings"
    wsOverview.Cells(3, 31).Formula = "=COUNTA('All Offerings'!A:A)-1"

    wsOverview.Cells(2, 32).Value = "Total Offer Amount (MM)"
    wsOverview.Cells(3, 32).Formula = "=SUM('All Offerings'!B2:B" & lastRow & ")"

    wsOverview.Cells(2, 33).Value = "Average Discount"
    wsOverview.Cells(3, 33).Formula = "=AVERAGE('All Offerings'!C2:C" & lastRow & ")"

    wsOverview.Cells(2, 34).Value = "Total Maturity Value (MM)"
    wsOverview.Cells(3, 34).Formula = "=SUM('All Offerings'!B2:B" & lastRow & "*(1+'All Offerings'!C2:C" & lastRow & "/100))"

    wsOverview.Cells(2, 35).Value = "Average Days to Maturity (DTM)"
    wsOverview.Cells(3, 35).Formula = "=AVERAGE('All Offerings'!D2:D" & lastRow & ")"

    wsOverview.Cells(2, 36).Value = "Total Net Upfront (MM)"
    wsOverview.Cells(3, 36).Formula = "=SUM('All Offerings'!V2:V" & lastRow & ")"

    ' Add more summary metrics as needed

    ' Format the "Overview" sheet
    wsOverview.Columns.AutoFit

    MsgBox "Overview sheet created successfully!", vbInformation
End Sub
