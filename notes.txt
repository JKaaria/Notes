Sub CompareSettleLegalEntity()
    Dim wsTradeData As Worksheet
    Dim wsLogicTable As Worksheet
    Dim tradeDataRange As Range
    Dim logicTableRange As Range
    Dim tradeDataDict As Object
    Dim logicTableDict As Object
    Dim cell As Range
    
    ' Set references to worksheets
    Set wsTradeData = ThisWorkbook.Sheets("TradeData")
    Set wsLogicTable = ThisWorkbook.Sheets("LogicTable")
    
    ' Assuming the data starts from the second row in both sheets
    Set tradeDataRange = wsTradeData.Range("A2", wsTradeData.Cells(wsTradeData.Rows.Count, 1).End(xlUp).Offset(0, 1))
    Set logicTableRange = wsLogicTable.Range("A2", wsLogicTable.Cells(wsLogicTable.Rows.Count, 2).End(xlUp).Offset(0, 1))
    
    ' Create dictionaries to store Settle Legal Entity values for each Counterparty ID
    Set tradeDataDict = CreateObject("Scripting.Dictionary")
    Set logicTableDict = CreateObject("Scripting.Dictionary")
    
    ' Populate dictionary for TradeData sheet
    For Each cell In tradeDataRange
        If Not tradeDataDict.Exists(cell.Value) Then
            tradeDataDict(cell.Value) = cell.Offset(0, 1).Value
        End If
    Next cell
    
    ' Populate dictionary for LogicTable sheet
    For Each cell In logicTableRange
        If Not logicTableDict.Exists(cell.Value) Then
            logicTableDict(cell.Value) = cell.Offset(0, 1).Value
        End If
    Next cell
    
    ' Compare and display results
    Dim key As Variant
    For Each key In tradeDataDict.Keys
        If logicTableDict.Exists(key) Then
            ' Compare Settle Legal Entity values
            If tradeDataDict(key) <> logicTableDict(key) Then
                MsgBox "Mismatch for Counterparty ID " & key & ": TradeData Settle Legal Entity is " & tradeDataDict(key) & ", LogicTable Settle Legal Entity is " & logicTableDict(key), vbExclamation
            End If
        Else
            MsgBox "Counterparty ID " & key & " not found in LogicTable", vbExclamation
        End If
    Next key
End Sub
