
Sub ApplyVLOOKUP()
    Dim wsOpenFissTrades As Worksheet
    Dim wsInventory As Worksheet
    Dim lastRowOpenFissTrades As Long
    Dim vlookupFormula As String
    Dim columnHeader As String
    
    ' Set references to the worksheets
    Set wsOpenFissTrades = ThisWorkbook.Sheets("Open Fiss Trades")
    Set wsInventory = ThisWorkbook.Sheets("Inventory")
    
    ' Find the last row in the "Open Fiss Trades" sheet
    lastRowOpenFissTrades = wsOpenFissTrades.Cells(wsOpenFissTrades.Rows.Count, "A").End(xlUp).Row
    
    ' Set the dynamic column header (you can change this if the header changes)
    columnHeader = "Contract Reference"
    
    ' Build the VLOOKUP formula
    vlookupFormula = "=VLOOKUP(I2, 'Inventory'!A:Z, 12, FALSE)"
    
    ' Loop through the cells under the dynamic column header and apply the VLOOKUP formula
    For Each cell In wsOpenFissTrades.Range("I2:I" & lastRowOpenFissTrades)
        If wsOpenFissTrades.Cells(1, cell.Column).Value = columnHeader Then
            cell.Formula = vlookupFormula
        End If
    Next cell
End Sub
