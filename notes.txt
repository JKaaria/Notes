Sub AnalyzeSectors()
    ' Declare variables
    Dim wsOfferings As Worksheet
    Dim wsOverview As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim sector As String
    Dim totalOfferAmt As Double
    Dim avgDiscount As Double
    Dim totalCoupons As Double
    Dim numOfferings As Long
    Dim sectorSummary As Object

    ' Set references to worksheets
    Set wsOfferings = ThisWorkbook.Sheets("All Offerings")
    Set wsOverview = ThisWorkbook.Sheets("Overview")

    ' Find the last row with data in the "All Offerings" sheet
    lastRow = wsOfferings.Cells(wsOfferings.Rows.Count, "A").End(xlUp).Row

    ' Initialize summary starting point
    wsOverview.Range("D1").Value = "Sector"
    wsOverview.Range("E1").Value = "Total Offer Amount (MM)"
    wsOverview.Range("F1").Value = "Average Discount"
    wsOverview.Range("G1").Value = "Total Coupons"
    wsOverview.Range("H1").Value = "Number of Offerings"

    ' Initialize dictionary to store sector-wise summaries
    Set sectorSummary = CreateObject("Scripting.Dictionary")

    ' Loop through each row in the "All Offerings" sheet
    For i = 2 To lastRow
        ' Get the sector from column X (assuming "Sector" is in column X)
        sector = wsOfferings.Cells(i, 24).Value ' Update the column index if "Sector" is in a different column

        ' Update summary metrics based on the sector
        If Not sectorSummary.Exists(sector) Then
            ' If the sector is not already in the dictionary, initialize metrics
            sectorSummary(sector) = Array(0, 0, 0, 0)
        End If

        ' Update metrics for the sector
        sectorSummary(sector)(0) = sectorSummary(sector)(0) + wsOfferings.Cells(i, 2).Value
        sectorSummary(sector)(1) = sectorSummary(sector)(1) + wsOfferings.Cells(i, 3).Value
        sectorSummary(sector)(2) = sectorSummary(sector)(2) + wsOfferings.Cells(i, 17).Value
        sectorSummary(sector)(3) = sectorSummary(sector)(3) + 1
    Next i

    ' Output summary metrics to the "Overview" sheet
    Dim outputRow As Long
    outputRow = 2

    For Each sector In sectorSummary.Keys
        wsOverview.Range("D" & outputRow).Value = sector
        wsOverview.Range("E" & outputRow).Value = sectorSummary(sector)(0)
        wsOverview.Range("F" & outputRow).Value = sectorSummary(sector)(1) / sectorSummary(sector)(3) ' Calculate average discount
        wsOverview.Range("G" & outputRow).Value = sectorSummary(sector)(2)
        wsOverview.Range("H" & outputRow).Value = sectorSummary(sector)(3)

        outputRow = outputRow + 1
    Next sector
End Sub
