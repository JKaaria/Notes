Sub One()
    Dim sourceFolderPath As String, sourceFileName As String, sourceFilePath As String
    Dim wsSource As Worksheet, wsTarget As Worksheet
    Dim targetSheetName As String
    
    ' Define the source folder path and file name pattern
    sourceFolderPath = ThisWorkbook.Path & "\"
    sourceFileName = "sstemp*.*"
    
    ' Specify the target sheet name
    targetSheetName = "TradeData"
    
    ' Construct the full path to the source file
    sourceFilePath = Dir(sourceFolderPath & sourceFileName)
    
    ' Check if the source file exists
    If sourceFilePath = "" Then
        MsgBox "Source file not found.", vbExclamation
    Else
        ' Set the source worksheet
        Workbooks.Open sourceFolderPath & sourceFilePath
        Set wsSource = ActiveWorkbook.Sheets(1)
        
        ' Set the target worksheet in the active workbook
        On Error Resume Next
        Set wsTarget = ThisWorkbook.Sheets(targetSheetName)
        On Error GoTo 0
        
        ' Clear the contents of the target sheet
        If Not wsTarget Is Nothing Then wsTarget.Cells.Clear
        
        ' If the target sheet doesn't exist, create it
        If wsTarget Is Nothing Then
            Set wsTarget = ThisWorkbook.Sheets.Add(After:=Sheets(Sheets.Count))
            wsTarget.Name = targetSheetName
        End If
        
        ' Copy data from source to target
        wsSource.UsedRange.Copy Destination:=wsTarget.Range("A1")
        
        ' Close the source workbook without saving changes
        ActiveWorkbook.Close SaveChanges:=False
    End If
End Sub

Sub Two()
    Dim wsTrade As Worksheet, lastRow As Long, settleLegalEntityCol As Integer, i As Long
    Set wsTrade = ThisWorkbook.Sheets("TradeData")
    settleLegalEntityCol = WorksheetFunction.Match("Settle Legal Entity", wsTrade.Rows(1), 0)
    lastRow = wsTrade.Cells(wsTrade.Rows.Count, settleLegalEntityCol).End(xlUp).Row
    
    For i = lastRow To 2 Step -1
        Dim currentValue As String
        currentValue = wsTrade.Cells(i, settleLegalEntityCol).Value
        
        ' Apply amendments
        If InStr(1, currentValue, "CAPITAL", vbTextCompare) > 0 Then
            wsTrade.Cells(i, settleLegalEntityCol).Value = "BCI"
        ElseIf InStr(1, currentValue, "PIC-NY", vbTextCompare) > 0 Or InStr(1, currentValue, "INBR", vbTextCompare) > 0 Then
            wsTrade.Cells(i, settleLegalEntityCol).Value = "LNER"
        Else
            wsTrade.Cells(i, settleLegalEntityCol).Value = "PLC"
        End If
    Next i
End Sub

Sub Three()
    Dim ws As Worksheet, lastRow As Long, filterColumn As Range, cell As Range
    Set ws = ThisWorkbook.Sheets("TradeData")
    lastRow = ws.Cells(ws.Rows.Count, "AW").End(xlUp).Row
    Set filterColumn = ws.Range("AW1:AW" & lastRow)
    
    For i = lastRow To 2 Step -1
        Set cell = filterColumn.Cells(i, 1)
        If Left(cell.Value, 5) <> "US912" Then
            cell.EntireRow.Delete
        End If
    Next i
End Sub

Sub Four()
    Dim wsTrade As Worksheet, counterpartyIDCol As Range
    Set wsTrade = ThisWorkbook.Sheets("TradeData")
    Set counterpartyIDCol = wsTrade.Rows(1).Find("Counterparty ID", LookIn:=xlValues, LookAt:=xlWhole)
    
    If Not counterpartyIDCol Is Nothing Then
        counterpartyIDCol.Value = "SD5"
    Else
        MsgBox "Counterparty ID header not found!", vbExclamation
    End If
End Sub

Sub Five()
    Dim wsTrade As Worksheet, settleLegalEntityCol As Range
    Set wsTrade = ThisWorkbook.Sheets("TradeData")
    Set settleLegalEntityCol = wsTrade.Rows(1).Find("Settle Legal Entity", LookIn:=xlValues, LookAt:=xlWhole)
    
    If Not settleLegalEntityCol Is Nothing Then
        settleLegalEntityCol.Value = "Entity"
    Else
        MsgBox "Settle Legal Entity header not found!", vbExclamation
    End If
End Sub

Sub Six()
    Dim wsTrade As Worksheet, wsLogic As Worksheet, wsResult As Worksheet
    Dim lastRowTrade As Long, lastRowLogic As Long, tradeSDSCol As Integer, logicSDSCol As Integer
    Dim resultRow As Long, i As Long
    
    Set wsTrade = ThisWorkbook.Sheets("TradeData")
    Set wsLogic = ThisWorkbook.Sheets("LogicTable")
    
    On Error Resume Next
    Set wsResult = ThisWorkbook.Sheets("ResultSheet")
    On Error GoTo 0
    
    If wsResult Is Nothing Then
        Set wsResult = ThisWorkbook.Sheets.Add(After:=Sheets(Sheets.Count))
        wsResult.Name = "ResultSheet"
    End If
    
    tradeSDSCol = WorksheetFunction.Match("SDS", wsTrade.Rows(1), 0)
    logicSDSCol = WorksheetFunction.Match("SDS", wsLogic.Rows(1), 0)
    
    lastRowTrade = wsTrade.Cells(wsTrade.Rows.Count, tradeSDSCol).End(xlUp).Row
    lastRowLogic = wsLogic.Cells(wsLogic.Rows.Count, logicSDSCol).End(xlUp).Row
    
    resultRow = 1
    
    For i = 2 To lastRowTrade
        Dim foundCell As Range
        Set foundCell = wsLogic.Columns(logicSDSCol).Find(wsTrade.Cells(i, tradeSDSCol).Value, LookIn:=xlValues, LookAt:=xlWhole)
        
        If Not foundCell Is Nothing Then
            wsResult.Cells(resultRow, 1).Value = wsTrade.Cells(i, tradeSDSCol).Value ' SDS
            wsResult.Cells(resultRow, 2).Value = wsTrade.Cells(i, WorksheetFunction.Match("Account Legal Name", wsTrade.Rows(1), 0)).Value ' Account Legal Name
            wsResult.Cells(resultRow, 3).Value = wsTrade.Cells(i, WorksheetFunction.Match("Trade ID", wsTrade.Rows(1), 0)).Value ' Trade ID
            wsResult.Cells(resultRow, 4).Value = wsTrade.Cells(i, WorksheetFunction.Match("Entity", wsTrade.Rows(1), 0)).Value ' Entity from TradeData
            wsResult.Cells(resultRow, 5).Value = wsLogic.Cells(foundCell.Row, WorksheetFunction.Match("Entity", wsLogic.Rows(1), 0)).Value ' Entity from LogicTable
            ' Add more columns here
            wsResult.Cells(resultRow, 6).Value = wsTrade.Cells(1, WorksheetFunction.Match("Quantity", wsTrade.Rows(1), 0)).Value ' Quantity
            wsResult.Cells(resultRow, 7).Value = wsTrade.Cells(i, WorksheetFunction.Match("Security Description", wsTrade.Rows(1), 0)).Value ' Security Description
            wsResult.Cells(resultRow, 8).Value = wsTrade.Cells(1, WorksheetFunction.Match("Settle Date", wsTrade.Rows(1), 0)).Value ' Settle Date
            
            resultRow = resultRow + 1
        End If
    Next i
End Sub

Sub Seven()
    Dim wsResult As Worksheet, lastRowResult As Long
    Dim outlookApp As Object, outlookMail As Object
    Dim emailBody As String
    
    Set wsResult = ThisWorkbook.Sheets("ResultSheet")
    
    lastRowResult = wsResult.Cells(wsResult.Rows.Count, 1).End(xlUp).Row
    
    If lastRowResult > 1 Then
        emailBody = "Mismatching Entities Details:" & vbCrLf
        
        For i = 2 To lastRowResult
            If wsResult.Cells(1, 4).Value <> wsResult.Cells(i, 5).Value Then
                emailBody = emailBody & "Row " & i & ": Entities do not match." & vbCrLf & _
                             "SDS: " & wsResult.Cells(i, 1).Value & vbCrLf & _
                             "Account Legal Name: " & wsResult.Cells(1, 2).Value & vbCrLf & _
                             "Trade ID: " & wsResult.Cells(i, 3).Value & vbCrLf & _
                             "Trade Data Entity: " & wsResult.Cells(i, 4).Value & vbCrLf & _
                             "Logic Table Entity: " & wsResult.Cells(i, 5).Value & vbCrLf & _
                             "Quantity: " & wsResult.Cells(1, 6).Value & vbCrLf & _
                             "Security Description: " & wsResult.Cells(i, 7).Value & vbCrLf & _
                             "Settle Date: " & wsResult.Cells(i, 8).Value & vbCrLf & vbCrLf
            End If
        Next i
        
        ' Create Outlook Application
        Set outlookApp = CreateObject("Outlook.Application")
        
        ' Create a new mail item
        Set outlookMail = outlookApp.CreateItem(0)
        
        ' Customize email properties
        With outlookMail
            .Subject = "T+0 UST Entity Matches - Regulatory/Financial Impact"
            .Body = emailBody & "Please wash today as per Logic Table Entity Stated." & vbCrLf & vbCrLf & _
                    "Kind Regards," & vbCrLf & _
                    "Jeremy Kaaria"
            .Recipients.Add "ukratessalessupport@barclays.com" ' Add recipient's email address
            .Send
        End With
        
        ' Release Outlook objects
        Set outlookMail = Nothing
        Set outlookApp = Nothing
    End If
End Sub
