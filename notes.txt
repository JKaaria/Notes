Sub Seven()
    ' Define variables
    Dim wResult As Worksheet
    Dim lastRowResult As Long
    Dim outlookApp As Object
    Dim outlookMail As Object
    Dim emailBody As String
    Dim i As Long
    
    ' Set worksheet
    Set wResult = ThisWorkbook.Sheets("ResultSheet") ' Replace "ResultSheet" with the actual name

    ' Find the last row in ResultSheet
    lastRowResult = wResult.Cells(wResult.Rows.Count, 1).End(xlUp).Row

    ' Initialize email body
    emailBody = "Mismatching Entities Details:" & vbCrLf & vbCrLf

    ' Loop through the rows in ResultSheet to check for matching entities
    For i = 2 To lastRowResult
        If wResult.Cells(i, 4).Value <> wResult.Cells(i, 5).Value Then
            ' Add details of mismatching row to email body
            emailBody = emailBody & "Row " & i & ": Entities do not match." & vbCrLf & _
                         " SDS: " & wResult.Cells(i, 1).Value & vbCrLf & _
                         "Account Legal Name: " & wResult.Cells(1, 2).Value & vbCrLf & _
                         "Trade ID: " & wResult.Cells(i, 3).Value & vbCrLf & _
                         "Trade Data Entity: " & wResult.Cells(i, 4).Value & vbCrLf & _
                         "Logic Table Entity: " & wResult.Cells(i, 5).Value & vbCrLf & _
                         "Quantity: " & wResult.Cells(i, 6).Value & vbCrLf & _
                         "Security Description: " & wResult.Cells(1, 7).Value & vbCrLf & _
                         "Settle Date: " & wResult.Cells(i, 8).Value & vbCrLf & vbCrLf
        End If
    Next i

    ' Create Outlook Application
    Set outlookApp = CreateObject("Outlook.Application")

    ' Create a new mail item
    Set outlookMail = outlookApp.CreateItem(0)

    ' Customize email properties
    With outlookMail
        .Subject = "T+0 UST Entity Matches - Regulatory/Financial Impact"
        .Body = emailBody & vbCrLf & "Please wash today as per Logic Table Entity Stated."
        .Recipients.Add "xratcubondprocessing@barclays.com"
        .Recipients.Add "lusratescashtatcu@barclays.com"
        .Display ' Display the email
    End With

    ' Release Outlook objects
    Set outlookMail = Nothing
    Set outlookApp = Nothing
End Sub

