Sub ChangeCounterpartyToSDS()

    ' Define variables
    Dim wsTrade As Worksheet
    Dim lastRow As Long
    Dim counterpartyCol As Integer
    Dim i As Long
    
    ' Set the worksheet
    Set wsTrade = ThisWorkbook.Sheets("TradeData") ' Replace "TradeData" with the actual name of your sheet
    
    ' Set column number based on header
    counterpartyCol = WorksheetFunction.Match("Counterparty", wsTrade.Rows(1), 0)
    
    ' Find the last row
    lastRow = wsTrade.Cells(wsTrade.Rows.Count, counterpartyCol).End(xlUp).Row
    
    ' Loop through the "Counterparty" column
    For i = 2 To lastRow
        Dim currentValue As Variant
        currentValue = wsTrade.Cells(i, counterpartyCol).Value
        
        ' Check if the content is numerical
        If IsNumeric(currentValue) Then
            ' Change the column header to "SDS"
            wsTrade.Cells(1, counterpartyCol).Value = "SDS"
            Exit For ' Exit loop after the first numerical value is found
        End If
    Next i
    
    MsgBox "Column header changed to 'SDS' if a numerical value was found.", vbInformation

End Sub
