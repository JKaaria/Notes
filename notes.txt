
Sub CheckTradeData()
    Dim wsTradeData As Worksheet
    Dim wsLogicTable As Worksheet
    Dim counterpartyColumn As Range
    Dim washRealignCodeColumn As Range
    Dim cell As Range

    ' Set references to sheets
    Set wsTradeData = ThisWorkbook.Sheets("TradeData")
    Set wsLogicTable = ThisWorkbook.Sheets("LogicTable")

    ' Find column indices in TradeData sheet
    Set counterpartyColumn = wsTradeData.Rows(1).Find("Counterparty")
    Set washRealignCodeColumn = wsTradeData.Rows(1).Find("Wash Realign Code")

    If counterpartyColumn Is Nothing Or washRealignCodeColumn Is Nothing Then
        MsgBox "Column headers not found in TradeData sheet."
        Exit Sub
    End If

    ' Loop through Counterparty column in TradeData
    For Each cell In wsTradeData.Range(wsTradeData.Cells(2, counterpartyColumn.Column), wsTradeData.Cells(wsTradeData.Rows.Count, counterpartyColumn.Column).End(xlUp))
        ' Check if Counterparty is in the list (AFRICAN DEV BK, BIS-BIS_PEND)
        If cell.Value = "AFRICAN DEV BK" Or cell.Value = "BIS-BIS_PEND" Then
            ' Find corresponding row in LogicTable
            Dim logicTableRow As Range
            Set logicTableRow = wsLogicTable.Columns(1).Find(cell.Value, LookIn:=xlValues)

            ' Check if LogicTable row is found
            If Not logicTableRow Is Nothing Then
                ' Check if Wash Realign Code matches
                If wsTradeData.Cells(cell.Row, washRealignCodeColumn.Column).Value <> wsLogicTable.Cells(logicTableRow.Row, 2).Value Then
                    MsgBox "Incorrect Wash Realign Code for Counterparty " & cell.Value
                End If
            Else
                MsgBox "Counterparty " & cell.Value & " not found in LogicTable."
            End If
        End If
    Next cell

    MsgBox "Macro complete."
End Sub