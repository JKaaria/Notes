Sub SimplifiedReconciliation()

    ' Define variables
    Dim wsTrade As Worksheet
    Dim lastRowTrade As Long
    Dim settleLegalEntityCol As Integer
    Dim i As Long
    
    ' Set worksheet
    Set wsTrade = ThisWorkbook.Sheets("TradeData") ' Replace "TradeData" with the actual name of your trade data sheet
    
    ' Set column number based on header
    settleLegalEntityCol = WorksheetFunction.Match("Settle Legal Entity", wsTrade.Rows(1), 0)
    
    ' Find the last row in the sheet
    lastRowTrade = wsTrade.Cells(wsTrade.Rows.Count, settleLegalEntityCol).End(xlUp).Row
    
    ' Loop through "Settle Legal Entity" column
    For i = 2 To lastRowTrade
        ' Check and replace values
        If InStr(1, UCase(wsTrade.Cells(i, settleLegalEntityCol).Value), "CAPITAL") > 0 Then
            wsTrade.Cells(i, settleLegalEntityCol).Value = "BCI"
        ElseIf InStr(1, UCase(wsTrade.Cells(i, settleLegalEntityCol).Value), "PLC-NY") > 0 Then
            wsTrade.Cells(i, settleLegalEntityCol).Value = "LNBR"
        Else
            ' Handle other cases (e.g., "PLC")
            ' Add more ElseIf conditions as needed
        End If
    Next i
    
    MsgBox "Reconciliation complete!", vbInformation

End Sub
