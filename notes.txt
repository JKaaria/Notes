Sub PerformSectorAnalysis()
    Dim wsAllOfferings As Worksheet
    Dim wsOverview As Worksheet
    Dim lastRow As Long
    Dim sectorColumn As Range
    Dim uniqueSectors As Collection
    Dim sector As Variant
    Dim rowNum As Long

    ' Set references to sheets
    On Error Resume Next
    Set wsAllOfferings = ThisWorkbook.Sheets("All Offerings")
    On Error GoTo 0

    If wsAllOfferings Is Nothing Then
        MsgBox "Sheet 'All Offerings' not found!", vbExclamation
        Exit Sub
    End If

    ' Check if "Overview" sheet already exists, if yes, delete it
    On Error Resume Next
    Application.DisplayAlerts = False
    Set wsOverview = ThisWorkbook.Sheets("Overview")
    On Error GoTo 0
    Application.DisplayAlerts = True

    If Not wsOverview Is Nothing Then
        Application.DisplayAlerts = False
        wsOverview.Delete
        Application.DisplayAlerts = True
    End If

    ' Create a new sheet named "Overview"
    Set wsOverview = Sheets.Add(After:=Sheets(Sheets.Count))
    wsOverview.Name = "Overview"

    ' Find the last row in the "All Offerings" sheet
    lastRow = wsAllOfferings.Cells(wsAllOfferings.Rows.Count, "A").End(xlUp).Row

    ' Copy headers to the "Overview" sheet
    wsAllOfferings.Rows(1).Copy wsOverview.Rows(1)

    ' Add headers for sector analysis
    wsOverview.Cells(1, 34).Value = "Sector Analysis"

    ' Find the column containing sector information
    Set sectorColumn = wsAllOfferings.Rows(1).Find(What:="Sector", LookIn:=xlValues, LookAt:=xlWhole)

    If Not sectorColumn Is Nothing Then
        ' Extract unique sectors using a collection
        Set uniqueSectors = New Collection

        For rowNum = 2 To lastRow
            On Error Resume Next
            uniqueSectors.Add wsAllOfferings.Cells(rowNum, sectorColumn.Column).Value, CStr(wsAllOfferings.Cells(rowNum, sectorColumn.Column).Value)
            On Error GoTo 0
        Next rowNum

        ' Add sector metrics to "Overview" sheet
        wsOverview.Cells(2, 34).Value = "Total Sectors"
        wsOverview.Cells(2, 35).Formula = "=COUNTA(" & sectorColumn.Address & ")-1"

        wsOverview.Cells(3, 34).Value = "Most Common Sector"
        wsOverview.Cells(3, 35).Formula = "=INDEX(" & sectorColumn.Address & ",MODE(MATCH(" & sectorColumn.Address & "," & sectorColumn.Address & ",0)))"

        ' Add more sector metrics as needed

    Else
        MsgBox "Sector column not found in 'All Offerings' sheet!", vbExclamation
    End If

    ' Format the "Overview" sheet
    wsOverview.Columns.AutoFit

    MsgBox "Sector Analysis completed successfully!", vbInformation
End Sub
