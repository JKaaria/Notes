Sub AnalyzeData()
    ' Define variables
    Dim wsAllOfferings As Worksheet
    Dim wsSummary As Worksheet
    Dim wsMetrics As Worksheet
    Dim wsVisualizations As Worksheet
    Dim lastRow As Long

    ' Set references to sheets
    Set wsAllOfferings = ThisWorkbook.Sheets("All Offerings")

    ' Create new sheets
    Set wsSummary = Sheets.Add(After:=Sheets(Sheets.Count))
    wsSummary.Name = "Summary"

    Set wsMetrics = Sheets.Add(After:=Sheets(Sheets.Count))
    wsMetrics.Name = "Metrics"

    Set wsVisualizations = Sheets.Add(After:=Sheets(Sheets.Count))
    wsVisualizations.Name = "Visualizations"

    ' Copy data to the Summary sheet
    wsAllOfferings.Copy After:=wsSummary

    ' Remove unnecessary columns in the Summary sheet
    wsSummary.Rows("1:1").AutoFilter
    wsSummary.Rows("1:1").AutoFilter Field:=1, Criteria1:="<>Issuer"

    ' Calculate metrics in the Metrics sheet
    ' Example: Calculate average coupon rate
    lastRow = wsMetrics.Cells(wsMetrics.Rows.Count, "A").End(xlUp).Row + 1
    wsMetrics.Cells(lastRow, 1).Value = "Average Coupon Rate"
    wsMetrics.Cells(lastRow, 2).Formula = "=AVERAGE(" & wsAllOfferings.Name & "!S2:S" & wsAllOfferings.Cells(wsAllOfferings.Rows.Count, "A").End(xlUp).Row & ")"

    ' Create visualizations in the Visualizations sheet
    ' Example: Create a bar chart for count of offerings by sector
    lastRow = wsAllOfferings.Cells(wsAllOfferings.Rows.Count, "A").End(xlUp).Row
    wsVisualizations.Shapes.AddChart2(251, xlColumnClustered).Select
    ActiveChart.SetSourceData Source:=wsAllOfferings.Range("Y2:Y" & lastRow)
    ActiveChart.Axes(xlCategory, xlPrimary).CategoryType = xlCategoryScale
    ActiveChart.SetElement (msoElementChartTitleAboveChart)
    ActiveChart.ChartTitle.Text = "Count of Offerings by Sector"
    ActiveChart.Parent.Name = "OfferingsBySectorChart"

    ' Add code to analyze patterns and draw insights
    ' You can customize this based on specific insights you want to draw

    MsgBox "Analysis completed successfully!"
End Sub
