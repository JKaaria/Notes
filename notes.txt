
Sub ImportDataFromExtractsFolder()
    Dim folderPath As String
    Dim fileName As String
    Dim wsMaster As Worksheet
    Dim wsTemp As Worksheet
    Dim lastRow As Long
    Dim headerRange As Range
    
    ' Set the folder path
    folderPath = ThisWorkbook.Path & "\Extracts\"
    
    ' Set the master sheet
    Set wsMaster = ThisWorkbook.Sheets("master")
    
    ' Create a temporary sheet to store each file's data
    Set wsTemp = ThisWorkbook.Sheets.Add
    
    ' Find the header range in the master sheet
    On Error Resume Next
    Set headerRange = wsMaster.Rows(1).Find("*", LookIn:=xlValues, LookAt:=xlWhole)
    On Error GoTo 0
    
    ' Loop through each file in the Extracts folder
    fileName = Dir(folderPath & "*.*")
    
    Do While fileName <> ""
        If fileName <> ThisWorkbook.Name Then ' Skip the current workbook
            ' Clear temporary sheet
            wsTemp.Cells.Clear
            
            ' Open the file and copy data to the temporary sheet
            With Workbooks.Open(folderPath & fileName)
                .Sheets(1).UsedRange.Copy wsTemp.Cells(1, 1)
                .Close SaveChanges:=False
            End With
            
            ' Check if headers are already present in the master sheet
            If headerRange Is Nothing Then
                ' Find the last non-empty row in the master sheet
                lastRow = wsMaster.Cells(wsMaster.Rows.Count, "A").End(xlUp).Row
            Else
                ' Headers are already present, so find the last non-empty row starting from row 2
                lastRow = wsMaster.Cells(wsMaster.Rows.Count, "A").End(xlUp).Row
                If lastRow > 1 Then
                    Do While Application.CountA(wsMaster.Rows(lastRow)) = 0
                        lastRow = lastRow - 1
                    Loop
                End If
            End If
            
            ' Copy data from the temporary sheet to the master sheet (excluding the last row if it contains "null" values)
            If Application.CountA(wsTemp.Rows(wsTemp.UsedRange.Rows.Count)) > 0 Then
                wsTemp.UsedRange.Copy wsMaster.Cells(lastRow + 1, 1)
            End If
        End If
        
        ' Get the next file
        fileName = Dir
    Loop
    
    ' Delete the temporary sheet
    Application.DisplayAlerts = False
    wsTemp.Delete
    Application.DisplayAlerts = True
End Sub




Sub MatchSDSIDsAndAppendStatus()
    Dim wsMaster As Worksheet
    Dim lastRowMaster As Long
    Dim sdsIdColumn As Range
    Dim cell As Range
    Dim matchFound As Boolean
    Dim statusColumn As Range
    
    ' Set the master sheet
    Set wsMaster = ThisWorkbook.Sheets("master")
    
    ' Find the last row in the master sheet
    lastRowMaster = wsMaster.Cells(wsMaster.Rows.Count, "B").End(xlUp).Row
    
    ' Set the SDS id column in the master sheet
    Set sdsIdColumn = wsMaster.Range("B2:B" & lastRowMaster)
    
    ' Add a new column for the status
    wsMaster.Cells(1, lastRowMaster + 2).Value = "Status"
    Set statusColumn = wsMaster.Range(wsMaster.Cells(2, lastRowMaster + 2), wsMaster.Cells(lastRowMaster + 1, lastRowMaster + 2))
    
    ' Loop through each cell in the SDS id column
    For Each cell In sdsIdColumn
        ' Reset match status
        matchFound = False
        
        ' Check for match in Sheet 2 (Column A)
        If WorksheetFunction.CountIf(Sheets(2).Columns("A"), cell.Value) > 0 Then
            matchFound = True
        End If
        
        ' Check for match in Sheet 3 (Column X)
        If WorksheetFunction.CountIf(Sheets(3).Columns("X"), cell.Value) > 0 Then
            matchFound = True
        End If
        
        ' Check for match in Sheet 4 (Column D)
        If WorksheetFunction.CountIf(Sheets(4).Columns("D"), cell.Value) > 0 Then
            matchFound = True
        End If
        
        ' Update the status column based on match
        If matchFound Then
            statusColumn.Cells(cell.Row - 1, 1).Value = "Match Found"
        Else
            statusColumn.Cells(cell.Row - 1, 1).Value = "Please Update SDS"
        End If
    Next cell
End Sub