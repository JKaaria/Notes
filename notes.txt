Sub ApplyVLOOKUP()
    Dim wsOpenFISS As Worksheet
    Dim wsInventory As Worksheet
    Dim lastRow As Long
    Dim contractRefColumn As Long

    ' Set references to the sheets
    Set wsOpenFISS = ThisWorkbook.Sheets("Open FISS Trades")
    Set wsInventory = ThisWorkbook.Sheets("Inventory")

    ' Find the "Contract Reference" column header in the "Open FISS Trades" sheet
    contractRefColumn = Application.Match("Contract Reference", wsOpenFISS.Rows(1), 0)

    ' Check if the header is found
    If Not IsError(contractRefColumn) Then
        ' Determine the last row in the "Open FISS Trades" sheet
        lastRow = wsOpenFISS.Cells(wsOpenFISS.Rows.Count, contractRefColumn).End(xlUp).Row

        ' Apply the VLOOKUP formula to each cell in the "Contract Reference" column
        For Each cell In wsOpenFISS.Range(wsOpenFISS.Cells(2, contractRefColumn), wsOpenFISS.Cells(lastRow, contractRefColumn))
            cell.Formula = "=VLOOKUP(" & cell.Address & ", 'Inventory'!A:Z, 12, FALSE)"
        Next cell
    Else
        MsgBox "Column header 'Contract Reference' not found in 'Open FISS Trades' sheet.", vbExclamation
    End If
End Sub

