Certainly! Below is a VBA script that creates a "Sector Analysis" on the "Overview" sheet, summarizing key metrics and insights on the distribution of offerings across sectors:

```vba
Sub CreateSectorAnalysis()
    Dim wsAllOfferings As Worksheet
    Dim wsOverview As Worksheet
    Dim lastRow As Long
    Dim uniqueSectors As Collection
    Dim sector As Variant
    Dim i As Long

    ' Set references to sheets
    On Error Resume Next
    Set wsAllOfferings = ThisWorkbook.Sheets("All Offerings")
    On Error GoTo 0

    If wsAllOfferings Is Nothing Then
        MsgBox "Sheet 'All Offerings' not found!", vbExclamation
        Exit Sub
    End If

    ' Check if "Overview" sheet already exists, if yes, delete it
    On Error Resume Next
    Application.DisplayAlerts = False
    Set wsOverview = ThisWorkbook.Sheets("Overview")
    On Error GoTo 0
    Application.DisplayAlerts = True

    If Not wsOverview Is Nothing Then
        Application.DisplayAlerts = False
        wsOverview.Delete
        Application.DisplayAlerts = True
    End If

    ' Create a new sheet named "Overview"
    Set wsOverview = Sheets.Add(After:=Sheets(Sheets.Count))
    wsOverview.Name = "Overview"

    ' Find the last row in the "All Offerings" sheet
    lastRow = wsAllOfferings.Cells(wsAllOfferings.Rows.Count, "A").End(xlUp).Row

    ' Add headers for sector analysis
    wsOverview.Cells(1, 4).Value = "Sector Analysis"

    ' Create a collection to store unique sectors
    Set uniqueSectors = New Collection

    ' Loop through the "Sector" column and collect unique sectors
    For i = 2 To lastRow
        On Error Resume Next
        uniqueSectors.Add wsAllOfferings.Cells(i, 24).Value, CStr(wsAllOfferings.Cells(i, 24).Value)
        On Error GoTo 0
    Next i

    ' Print sector names in column D starting from D2
    wsOverview.Range("D2").Resize(uniqueSectors.Count, 1).Value = WorksheetFunction.Transpose(uniqueSectors.Items)

    ' Loop through each sector and calculate metrics
    For i = 2 To uniqueSectors.Count + 1
        sector = wsOverview.Cells(i, 4).Value

        ' Total Offerings in the sector
        wsOverview.Cells(i, 5).Formula = "=COUNTIF('All Offerings'!Y:Y,""" & sector & """)"

        ' Total Offer Amount in the sector (MM)
        wsOverview.Cells(i, 6).Formula = "=SUMIFS('All Offerings'!B:B, 'All Offerings'!Y:Y, """ & sector & """)"

        ' Average Discount in the sector
        wsOverview.Cells(i, 7).Formula = "=AVERAGEIFS('All Offerings'!C:C, 'All Offerings'!Y:Y, """ & sector & """)"

        ' Add more sector-specific metrics as needed
    Next i

    ' Format the "Overview" sheet
    wsOverview.Columns.AutoFit

    MsgBox "Sector Analysis created successfully!", vbInformation
End Sub
```

This script calculates key metrics such as total offerings, total offer amount, and average discount for each sector. You can add more sector-specific metrics as needed. The results start from cell D1 on the "Overview" sheet. Adjust the code based on your specific requirements for sector analysis.
