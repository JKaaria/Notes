Sub AnalyseIssuers()
    Dim wsAllOfferings As Worksheet
    Dim wsOverview As Worksheet
    Dim lastRow As Long
    Dim uniqueIssuers As Collection
    Dim issuer As Variant
    Dim countIssuers As Long
    Dim i As Long
    
    ' Set worksheets
    Set wsAllOfferings = ThisWorkbook.Sheets("All Offerings")
    Set wsOverview = ThisWorkbook.Sheets("Overview")
    
    ' Clear previous data in Overview sheet
    wsOverview.Range("Q:S").Clear
    
    ' Find the last row in All Offerings sheet
    lastRow = wsAllOfferings.Cells(wsAllOfferings.Rows.Count, "A").End(xlUp).Row
    
    ' Initialize collections
    Set uniqueIssuers = New Collection
    
    ' Loop through All Offerings sheet to gather unique issuers
    On Error Resume Next
    For i = 2 To lastRow ' Assuming headers are in row 1
        uniqueIssuers.Add wsAllOfferings.Cells(i, "A").Value, CStr(wsAllOfferings.Cells(i, "A").Value)
    Next i
    On Error GoTo 0
    
    ' Write titles to the Overview sheet
    wsOverview.Cells(1, "Q").Value = "Issuer"
    wsOverview.Cells(1, "R").Value = "Count"
    
    ' Loop through unique issuers and count occurrences
    For Each issuer In uniqueIssuers
        countIssuers = Application.WorksheetFunction.CountIf(wsAllOfferings.Range("A:A"), issuer)
        
        ' Write results to Overview sheet
        wsOverview.Cells(wsOverview.Rows.Count, "Q").End(xlUp).Offset(1, 0).Value = issuer
        wsOverview.Cells(wsOverview.Rows.Count, "R").End(xlUp).Offset(1, 0).Value = countIssuers
    Next issuer
End Sub
