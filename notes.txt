Sub SortAndAppendRecentTrades()
    Dim wsTradeData As Worksheet
    Dim wsT0Bookings As Worksheet
    Dim lastRowTradeData As Long
    Dim lastRowT0Bookings As Long
    Dim recentTradeDate As Date
    
    ' Set the worksheets
    Set wsTradeData = ThisWorkbook.Sheets("TradeData")
    Set wsT0Bookings = ThisWorkbook.Sheets("T+0 WI Bookings")
    
    ' Find the last row with data in TradeData sheet
    lastRowTradeData = wsTradeData.Cells(wsTradeData.Rows.Count, "A").End(xlUp).Row
    
    ' Sort the TradeData by Trade Date in descending order
    wsTradeData.Sort.SortFields.Clear
    wsTradeData.Sort.SortFields.Add Key:=Range("A2:A" & lastRowTradeData), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
    With wsTradeData.Sort
        .SetRange Range("A1:A" & lastRowTradeData + 1) ' Include the header row in the sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
    ' Get the trade date of the most recent trade
    recentTradeDate = wsTradeData.Cells(2, 1).Value
    
    ' Find the last row with data in T+0 WI Bookings sheet
    lastRowT0Bookings = wsT0Bookings.Cells(wsT0Bookings.Rows.Count, "A").End(xlUp).Row
    
    ' Copy recent trades to T+0 WI Bookings sheet
    Dim i As Long
    For i = 2 To lastRowTradeData ' Assuming data starts from row 2
        If wsTradeData.Cells(i, 1).Value = recentTradeDate Then
            ' Copy the entire row to the T+0 WI Bookings sheet
            wsTradeData.Rows(i).Copy Destination:=wsT0Bookings.Rows(lastRowT0Bookings + 1)
            lastRowT0Bookings = lastRowT0Bookings + 1
        Else
            ' Since the data is sorted, we can exit the loop once we find a trade with a different date
            Exit For
        End If
    Next i
    
    ' Optional: Clear the sorted TradeData sheet if needed
    ' wsTradeData.Sort.SortFields.Clear
End Sub
