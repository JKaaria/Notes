Sub UpdateSettleLegalEntity()
    Dim wsTradeData As Worksheet
    Dim wsLogicTable As Worksheet
    Dim logicTable As Range
    Dim tradeDataColumn As Range
    Dim cell As Range
    
    ' Set references to worksheets
    Set wsTradeData = ThisWorkbook.Sheets("TradeData")
    Set wsLogicTable = ThisWorkbook.Sheets("LogicTable")
    
    ' Set reference to logic table range
    Set logicTable = wsLogicTable.Range("A1:F1") ' Assuming the logic table is in the first row
    
    ' Find the column index for "Settle Legal Entity"
    Set tradeDataColumn = wsTradeData.Rows(1).Find("Settle Legal Entity", LookIn:=xlValues, LookAt:=xlWhole)
    
    ' Check if the column exists
    If Not tradeDataColumn Is Nothing Then
        ' Loop through each cell in the "Settle Legal Entity" column starting from the second row
        For Each cell In wsTradeData.Range(wsTradeData.Cells(2, tradeDataColumn.Column), wsTradeData.Cells(wsTradeData.Rows.Count, tradeDataColumn.Column).End(xlUp))
            ' Check and update values based on logic table
            Select Case cell.Value
                Case "CAPITAL"
                    cell.Value = "BCI"
                Case "PLC-NY"
                    cell.Value = "LNBR"
                Case Else
                    ' Check against logic table for additional replacements
                    Dim logicCell As Range
                    For Each logicCell In logicTable
                        If cell.Value = logicCell.Value Then
                            ' Replace with the value in the corresponding logic table cell
                            cell.Value = logicCell.Offset(0, 1).Value
                            Exit For
                        End If
                    Next logicCell
            End Select
        Next cell
    Else
        MsgBox "Column 'Settle Legal Entity' not found in TradeData sheet.", vbExclamation
    End If
End Sub
