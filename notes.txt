Sub ConsolidateData()
    Dim ws As Worksheet
    Dim resultsSheet As Worksheet
    Dim podFilter As String
    Dim lastRow As Long
    Dim destRow As Long
    
    ' Set the results sheet
    Set resultsSheet = ThisWorkbook.Sheets("Results")
    
    ' Loop through each sheet
    For Each ws In ThisWorkbook.Sheets
        ' Skip the Results sheet
        If ws.Name <> "Results" Then
            ' Filter by Pod = "Italy"
            ws.Rows(1).AutoFilter Field:=1, Criteria1:="Italy"
            
            ' Find the last row after filtering
            lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
            
            ' Loop through visible rows
            For i = 2 To lastRow
                If ws.Rows(i).Hidden = False Then
                    ' Copy data to the results sheet
                    destRow = resultsSheet.Cells(resultsSheet.Rows.Count, "A").End(xlUp).Row + 1
                    resultsSheet.Cells(destRow, 1).Value = ws.Cells(i, "A").Value ' Pod
                    resultsSheet.Cells(destRow, 2).Value = ws.Cells(i, "B").Value ' Counterparty Code
                    resultsSheet.Cells(destRow, 3).Value = ws.Cells(i, "C").Value ' Salesman Name
                    resultsSheet.Cells(destRow, 4).Value = ws.Cells(i, "D").Value ' Level 07 Node Name
                    resultsSheet.Cells(destRow, 5).Value = ws.Cells(i, "E").Value ' Buying Center Name
                End If
            Next i
            
            ' Turn off the filter
            ws.AutoFilterMode = False
        End If
    Next ws
End Sub
