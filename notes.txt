Sub CheckMatchingEntities()

    ' Define variables
    Dim wsResult As Worksheet
    Dim lastRowResult As Long
    Dim outlookApp As Object
    Dim outlookMail As Object
    
    ' Set worksheet
    Set wsResult = ThisWorkbook.Sheets("ResultSheet") ' Replace "ResultSheet" with the actual name of your sheet
    
    ' Find the last row in ResultSheet
    lastRowResult = wsResult.Cells(wsResult.Rows.Count, 1).End(xlUp).Row
    
    ' Create Outlook Application
    Set outlookApp = CreateObject("Outlook.Application")

    ' Loop through the rows in ResultSheet to check for matching entities
    For i = 2 To lastRowResult
        If wsResult.Cells(i, 4).Value = wsResult.Cells(i, 5).Value Then
            ' Entities match, send email
            Set outlookMail = outlookApp.CreateItem(0)
            
            ' Customize email properties
            With outlookMail
                .Subject = "Matching Entities Detected"
                .Body = "Row " & i & ": Entities match in ResultSheet." & vbCrLf & vbCrLf
                
                ' Add row contents to email body
                For col = 1 To wsResult.Columns.Count
                    .Body = .Body & wsResult.Cells(i, col).Value & vbCrLf
                Next col
                
                ' Add recipient's email address from Column F
                .Recipients.Add wsResult.Cells(i, 6).Value
                
                ' Send the email
                .Send
            End With
            
            MsgBox "Row " & i & ": Entities match. Email sent.", vbInformation
        Else
            MsgBox "Row " & i & ": Entities do not match.", vbExclamation
        End If
    Next i

    ' Release Outlook objects
    Set outlookMail = Nothing
    Set outlookApp = Nothing

End Sub
