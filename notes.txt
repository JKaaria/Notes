Sub ExtractKeyInsights()
    Dim olApp As Outlook.Application
    Dim olNamespace As Outlook.NameSpace
    Dim olFolder As Outlook.MAPIFolder
    Dim olMail As Outlook.MailItem
    Dim strFolderPath As String
    Dim strSenderEmail As String
    Dim xlApp As Object
    Dim xlWorkbook As Object
    Dim xlWorksheet As Object
    Dim LastRow As Long
    Dim i As Integer
    
    ' Define the folder path where .msg files are stored
    strFolderPath = "C:\Path\To\Your\Emails"
    
    ' Define the sender's email address
    strSenderEmail = InputBox("Enter the sender's email address:")
    
    ' Create an Excel application
    Set xlApp = CreateObject("Excel.Application")
    xlApp.Visible = True
    
    ' Create a new workbook and worksheet
    Set xlWorkbook = xlApp.Workbooks.Add
    Set xlWorksheet = xlWorkbook.Sheets(1)
    
    ' Set up Excel headers
    xlWorksheet.Cells(1, 1).Value = "Subject"
    xlWorksheet.Cells(1, 2).Value = "Received Date"
    xlWorksheet.Cells(1, 3).Value = "Body"
    
    ' Connect to Outlook
    Set olApp = New Outlook.Application
    Set olNamespace = olApp.GetNamespace("MAPI")
    Set olFolder = olNamespace.GetDefaultFolder(olFolderInbox)
    
    ' Loop through the items in the folder
    For Each olMail In olFolder.Items
        If olMail.Class = olMail Then
            ' Check if the sender's email address matches
            If LCase(olMail.SenderEmailAddress) = LCase(strSenderEmail) Then
                ' Find the last row in the Excel worksheet
                LastRow = xlWorksheet.Cells(xlWorksheet.Rows.Count, 1).End(-4162).Row
                
                ' Extract and write information to Excel
                xlWorksheet.Cells(LastRow + 1, 1).Value = olMail.Subject
                xlWorksheet.Cells(LastRow + 1, 2).Value = olMail.ReceivedTime
                xlWorksheet.Cells(LastRow + 1, 3).Value = olMail.Body
            End If
        End If
    Next olMail
    
    ' Release objects
    Set olApp = Nothing
    Set olNamespace = Nothing
    Set olFolder = Nothing
    Set xlApp = Nothing
    Set xlWorkbook = Nothing
    Set xlWorksheet = Nothing
End Sub
