Sub FilterUS_Treasury()
    Dim wsTrade As Worksheet
    Dim issuerAbbrevHeader As Range
    Dim rngIssuerAbbrev As Range

    ' Set worksheet
    Set wsTrade = ThisWorkbook.Sheets("TradeData") ' Replace "TradeData" with the actual name of your trade data sheet

    ' Find "Issuer Abbrev" column header
    On Error Resume Next
    Set issuerAbbrevHeader = wsTrade.Rows(1).Find("Issuer Abbrev", LookIn:=xlValues)
    On Error GoTo 0

    ' Check if header is found
    If Not issuerAbbrevHeader Is Nothing Then
        ' Set range for "Issuer Abbrev" column
        Set rngIssuerAbbrev = wsTrade.Columns(issuerAbbrevHeader.Column)

        ' Apply AutoFilter to "Issuer Abbrev" column for records containing "US Treasury"
        rngIssuerAbbrev.AutoFilter Field:=1, Criteria1:="=*US Treasury*"

        ' Display a message (you can modify this part as needed)
        MsgBox "Issuer Abbrev column filtered for records containing 'US Treasury'.", vbInformation
    Else
        MsgBox "Column header 'Issuer Abbrev' not found!", vbExclamation
    End If
End Sub
