Sub AnalyzeCreditRatings()
    Dim wsAllOfferings As Worksheet
    Dim wsOverview As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim rating As String
    Dim spCount As Long, moodyCount As Long, fitchCount As Long
    
    ' Set references to the worksheets
    Set wsAllOfferings = ThisWorkbook.Sheets("All Offerings")
    Set wsOverview = ThisWorkbook.Sheets("Overview")
    
    ' Find the last row in column H (assuming there's data in column H)
    lastRow = wsAllOfferings.Cells(wsAllOfferings.Rows.Count, "H").End(xlUp).Row
    
    ' Clear existing data in Overview sheet from column I onwards
    wsOverview.Range("I:ZZ").Clear
    
    ' Loop through the data in the All Offerings sheet
    For i = 2 To lastRow ' Assuming row 1 is headers
        
        ' Get the rating from each column
        rating = wsAllOfferings.Cells(i, 8).Value ' Column H (Client Reg Category)
        
        ' Check S&P rating (Column I)
        If rating <> "" Then
            wsOverview.Cells(2, 9).Value = wsOverview.Cells(2, 9).Value + 1
            wsOverview.Cells(2, 9 + spCount).Value = rating
            spCount = spCount + 1
        End If
        
        ' Check Moody rating (Column J)
        rating = wsAllOfferings.Cells(i, 9).Value ' Column I (S&P Ratings)
        If rating <> "" Then
            wsOverview.Cells(2, 10).Value = wsOverview.Cells(2, 10).Value + 1
            wsOverview.Cells(2, 10 + moodyCount).Value = rating
            moodyCount = moodyCount + 1
        End If
        
        ' Check Fitch rating (Column K)
        rating = wsAllOfferings.Cells(i, 10).Value ' Column J (Moody Ratings)
        If rating <> "" Then
            wsOverview.Cells(2, 11).Value = wsOverview.Cells(2, 11).Value + 1
            wsOverview.Cells(2, 11 + fitchCount).Value = rating
            fitchCount = fitchCount + 1
        End If
        
        ' Add any additional metrics as needed
        
    Next i
    
    ' Add headers to the Overview sheet
    wsOverview.Cells(1, 9).Value = "S&P Ratings"
    wsOverview.Cells(1, 10).Value = "Moody Ratings"
    wsOverview.Cells(1, 11).Value = "Fitch Ratings"
    
End Sub
