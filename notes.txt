
Sub SortTradeDataByDate()
    Dim ws As Worksheet
    Dim lastRow As Long
    
    ' Set the worksheet variable to the "TradeData" sheet
    Set ws = ThisWorkbook.Sheets("TradeData")
    
    ' Find the last row in the "Trade Date" column
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' Sort the data based on the "Trade Date" column in descending order
    ws.Sort.SortFields.Clear
    ws.Sort.SortFields.Add Key:=Range("B2:B" & lastRow), _
        SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortTextAsNumbers
    With ws.Sort
        .SetRange Range("A1:Z" & lastRow) ' Adjust the range accordingly
        .Header = xlYes ' Assumes the first row contains headers
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
    ' Your code to loop through the sorted data goes here
    ' Example: (replace this with your actual processing logic)
    For i = 2 To lastRow
        ' Access each row using ws.Cells(i, ColumnNumber)
        ' Example: tradeDate = ws.Cells(i, 2).Value
        ' Your processing logic goes here
    Next i
End Sub
