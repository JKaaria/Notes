Sub SortFailCodes()
    Dim ws As Worksheet
    Dim lastRow As Long

    ' Set the worksheet variable
    Set ws = ThisWorkbook.Sheets("AFT")

    ' Find the last row in column A (assuming column A has data)
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row

    ' Sort the range based on the "Fail Code" column
    With ws.Sort
        .SortFields.Clear
        .SortFields.Add Key:=ws.Range("A1:A" & lastRow), _
            SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
        .SetRange ws.Range("A1:ZZ" & lastRow) ' Adjust ZZ to the last column with data
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
End Sub

