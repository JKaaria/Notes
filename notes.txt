Sub Six()
    ' Define variables
    Dim wsTrade As Worksheet
    Dim wsLogic As Worksheet
    Dim wsResult As Worksheet
    Dim lastRowTrade As Long
    Dim lastRowLogic As Long
    Dim tradeSDSCol As Integer
    Dim logicSDSCol As Integer
    Dim resultRow As Long
    Dim i As Long

    ' Set worksheets
    Set wsTrade = ThisWorkbook.Sheets("TradeData")
    Set wsLogic = ThisWorkbook.Sheets("LogicTable")

    ' Create or reference "ResultSheet"
    On Error Resume Next
    Set wsResult = ThisWorkbook.Sheets("ResultSheet")
    On Error GoTo 0
    
    If wsResult Is Nothing Then
        ' If "ResultSheet" sheet doesn't exist, create it
        Set wsResult = ThisWorkbook.Sheets.Add(After:=Sheets(Sheets.Count))
        wsResult.Name = "ResultSheet"
    End If

    ' Set column numbers based on headers
    tradeSDSCol = WorksheetFunction.Match("SDS", wsTrade.Rows(1), 0)
    logicSDSCol = WorksheetFunction.Match("SDS", wsLogic.Rows(1), 0)

    ' Find the last rows in each sheet
    lastRowTrade = wsTrade.Cells(wsTrade.Rows.Count, tradeSDSCol).End(xlUp).Row
    lastRowLogic = wsLogic.Cells(wsLogic.Rows.Count, logicSDSCol).End(xlUp).Row

    ' Initialize row number for ResultSheet
    resultRow = 1

    ' Loop through TradeData sheet
    For i = 2 To lastRowTrade
        ' Search for SDS value in LogicTable
        Dim foundCell As Range
        Set foundCell = wsLogic.Columns(logicSDSCol).Find(wsTrade.Cells(i, tradeSDSCol).Value, LookIn:=xlValues, LookAt:=xlWhole)

        ' If a match is found, copy relevant information to ResultSheet
        If Not foundCell Is Nothing Then
            wsResult.Cells(resultRow, 1).Value = wsTrade.Cells(1, tradeSDSCol).Value ' SDS
            wsResult.Cells(resultRow, 2).Value = wsTrade.Cells(i, WorksheetFunction.Match("Account Legal Name", wsTrade.Rows(1), 0)).Value ' Account Legal Name
            wsResult.Cells(resultRow, 3).Value = wsTrade.Cells(1, WorksheetFunction.Match("Trade ID", wsTrade.Rows(1), 0)).Value ' Trade ID
            wsResult.Cells(resultRow, 4).Value = wsTrade.Cells(i, WorksheetFunction.Match("Entity", wsTrade.Rows(1), 0)).Value ' Entity from TradeData
            wsResult.Cells(resultRow, 5).Value = wsLogic.Cells(foundCell.Row, WorksheetFunction.Match("Entity", wsLogic.Rows(1), 0)).Value ' Entity from LogicTable
            wsResult.Cells(resultRow, 6).Value = wsTrade.Cells(i, WorksheetFunction.Match("Quantity", wsTrade.Rows(1), 0)).Value ' Quantity
            wsResult.Cells(resultRow, 7).Value = wsTrade.Cells(1, WorksheetFunction.Match("Security Description", wsTrade.Rows(1), 0)).Value ' Security Description
            wsResult.Cells(resultRow, 8).Value = wsTrade.Cells(1, WorksheetFunction.Match("Settle Date", wsTrade.Rows(1), 0)).Value ' Settle Date
            resultRow = resultRow + 1
        End If
    Next i
End Sub
