 ' Loop through rows in sheet1
    For i = 2 To lastRow1 ' Start from the second row to skip headers
        ' Get the value to match from column B of sheet1
        valueToMatch = sheet1.Cells(i, "BO").Value
        
        ' Check if the value exists in column B of sheet2
        If WorksheetFunction.CountIf(sheet2.Range("B1:B" & lastRow2), valueToMatch) > 0 Then
            ' Copy the entire row from sheet1 to resultsSheet
            sheet1.Rows(i).Copy resultsSheet.Rows(resultsRow)
            
            ' Find the corresponding row in CBLogicTable and get the value from column C
            Set logicTable = ThisWorkbook.Sheets("CBLogicTable")
            lookupValue = Application.VLookup(valueToMatch, logicTable.Range("B1:C" & lastRow2), 2, False)
            
            ' Paste the value into the initial row in CBCreditTrades sheet (column A)
            resultsSheet.Cells(resultsRow, 1).Value = lookupValue
            
            resultsRow = resultsRow + 1
        End If
    Next i
End Sub

