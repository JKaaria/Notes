Sub AutomateWorkflow()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim filterCriteria As Variant
    Dim delphiRange As Range

    ' Set the worksheet
    Set ws = ThisWorkbook.Sheets("Delphi") ' Change "Delphi" to the actual sheet name

    ' Find the last row with data
    lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row

    ' Set the filter criteria for column A
    filterCriteria = Array("Open", "#N/A")

    ' Apply AutoFilter to column A
    ws.AutoFilterMode = False
    ws.Range("A1:A" & lastRow).AutoFilter Field:=1, Criteria1:=filterCriteria, Operator:=xlFilterValues

    ' Remove rows with "Not For Us" in column B
    On Error Resume Next
    ws.Range("B2:B" & lastRow).SpecialCells(xlCellTypeVisible).EntireRow.Delete
    On Error GoTo 0

    ' Clear existing grouping
    On Error Resume Next
    ws.Outline.ShowLevels RowLevels:=0, ColumnLevels:=0
    On Error GoTo 0

    ' Group by Source Status (Column O)
    Set delphiRange = ws.Range("A1:O" & lastRow)
    delphiRange.Columns("O").EntireColumn.Group

    ' Turn off AutoFilter
    ws.AutoFilterMode = False
End Sub
