Sub AnalyzeRatings()
    Dim ws As Worksheet
    Dim dataWs As Worksheet
    Dim overviewWs As Worksheet
    Dim lastRow As Long
    Dim ratingCell As Range
    Dim rating As String
    
    ' Set references to worksheets
    Set dataWs = ThisWorkbook.Sheets("All Offerings")
    Set overviewWs = ThisWorkbook.Sheets("Overview")
    
    ' Find the last row in column H
    lastRow = dataWs.Cells(dataWs.Rows.Count, "H").End(xlUp).Row
    
    ' Create a summary table in the Overview sheet
    overviewWs.Cells.Clear
    overviewWs.Range("A1").Value = "Rating"
    overviewWs.Range("B1").Value = "Count"
    
    ' Loop through each row and analyze ratings
    For Each ratingCell In dataWs.Range("H2:H" & lastRow)
        ' Assuming that each rating is separated by a "|"
        Dim ratingsArray() As String
        ratingsArray = Split(ratingCell.Value, "|")
        
        ' Loop through each element in the ratingsArray
        For Each rating In ratingsArray
            ' Trim the rating to remove any leading/trailing spaces
            rating = Trim(rating)
            
            ' Check if the rating is not empty
            If Len(rating) > 0 Then
                ' Increment the count in the summary table
                On Error Resume Next
                overviewWs.Range("A2").Resize(100, 1).Find(rating).Offset(0, 1).Value = overviewWs.Range("A2").Resize(100, 1).Find(rating).Offset(0, 1).Value + 1
                On Error GoTo 0
            End If
        Next rating
    Next ratingCell
    
    ' Add headers to columns in the Overview sheet
    overviewWs.Range("A:A").Insert Shift:=xlToRight
    overviewWs.Range("A1").Value = "Overview"
    overviewWs.Range("B1").Value = "Analysis"
    overviewWs.Range("A2").Value = "Total Offerings"
    overviewWs.Range("B2").Formula = "=COUNTA('All Offerings'!A:A)"
    
    ' Add additional analyses based on your requirements in columns J and K
    
    ' Example Analysis in Column J: Count of Offerings with Credit Ratings
    overviewWs.Range("A3").Value = "Offerings with Credit Ratings"
    overviewWs.Range("B3").Formula = "=COUNTIF('All Offerings'!H:H, ""*|*|*"")"
    
    ' Example Analysis in Column K: Average Discount for Offerings with Credit Ratings
    overviewWs.Range("A4").Value = "Average Discount for Offerings with Credit Ratings"
    overviewWs.Range("B4").Formula = "=AVERAGEIFS('All Offerings'!C:C, 'All Offerings'!H:H, ""*|*|*"")"
    
    ' Additional analyses can be added as per your requirements
    
End Sub
