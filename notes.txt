Sub SendEmailToKaaria()

    ' Define variables
    Dim wsResults As Worksheet
    Dim outlookApp As Object
    Dim outlookMail As Object
    Dim rngCoreDetails As Range
    Dim lastRow As Long
    Dim coreDetails As String
    Dim i As Long
    
    ' Set worksheet
    On Error Resume Next
    Set wsResults = ThisWorkbook.Sheets("ResultsSheet")
    On Error GoTo 0
    
    ' Check if "ResultsSheet" exists
    If Not wsResults Is Nothing Then
        ' Find the last row in the sheet
        lastRow = wsResults.Cells(wsResults.Rows.Count, 1).End(xlUp).Row
        
        ' Check if there are any results to send
        If lastRow > 1 Then
            ' Set range for core details columns
            Set rngCoreDetails = wsResults.Range("A1:I" & lastRow)
            
            ' Concatenate core details for each row
            For i = 2 To lastRow
                coreDetails = coreDetails & vbCrLf & Join(Application.Index(rngCoreDetails.Value, i, 0), ", ")
            Next i
            
            ' Create Outlook application
            On Error Resume Next
            Set outlookApp = CreateObject("Outlook.Application")
            On Error GoTo 0
            
            ' Check if Outlook is available
            If Not outlookApp Is Nothing Then
                ' Create a new email
                Set outlookMail = outlookApp.CreateItem(0)
                
                ' Set email properties
                With outlookMail
                    .To = "j.kaaria@barclays.com"
                    .Subject = "ResultsSheet Core Details"
                    .Body = "Core Details from ResultsSheet:" & vbCrLf & coreDetails
                    .Display ' Change to .Send to automatically send the email
                End With
                
                ' Release Outlook objects
                Set outlookMail = Nothing
                Set outlookApp = Nothing
            Else
                MsgBox "Outlook is not available.", vbExclamation
            End If
        Else
            MsgBox "No results to send.", vbInformation
        End If
    Else
        MsgBox "Sheet 'ResultsSheet' not found.", vbExclamation
    End If

End Sub
