Sub DeleteRowsNotStartingWithUS912()
    Dim wsTrade As Worksheet
    Dim isinHeader As Range
    Dim rngISIN As Range
    Dim cell As Range

    ' Set worksheet
    Set wsTrade = ThisWorkbook.Sheets("TradeData") ' Replace "TradeData" with the actual name of your trade data sheet

    ' Find "ISIN" column header
    On Error Resume Next
    Set isinHeader = wsTrade.Rows(1).Find("ISIN", LookIn:=xlValues)
    On Error GoTo 0

    ' Check if header is found
    If Not isinHeader Is Nothing Then
        ' Set range for "ISIN" column
        Set rngISIN = wsTrade.Columns(isinHeader.Column)

        ' Loop through each cell in the "ISIN" column
        For Each cell In rngISIN.Offset(1, 0).Resize(wsTrade.Rows.Count - 1, 1)
            ' Check if ISIN does not begin with "US912"
            If UCase(Left(cell.Value, 6)) <> "US912" Then
                ' Delete entire row
                cell.EntireRow.Delete
            End If
        Next cell

        ' Display a message (you can modify this part as needed)
        MsgBox "Rows deleted where ISIN does not begin with 'US912'.", vbInformation
    Else
        MsgBox "Column header 'ISIN' not found!", vbExclamation
    End If
End Sub
