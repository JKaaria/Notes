Sub AnalyzeSectors()
    ' Declare variables
    Dim wsOfferings As Worksheet
    Dim wsOverview As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim sector As String
    Dim totalOfferAmt As Double
    Dim avgDiscount As Double
    Dim totalCoupons As Double
    Dim numOfferings As Long

    ' Set references to worksheets
    Set wsOfferings = ThisWorkbook.Sheets("All Offerings")
    Set wsOverview = ThisWorkbook.Sheets("Overview")

    ' Find the last row with data in the "All Offerings" sheet
    lastRow = wsOfferings.Cells(wsOfferings.Rows.Count, "A").End(xlUp).Row

    ' Initialize summary starting point
    wsOverview.Range("D1").Value = "Sector"
    wsOverview.Range("E1").Value = "Total Offer Amount (MM)"
    wsOverview.Range("F1").Value = "Average Discount"
    wsOverview.Range("G1").Value = "Total Coupons"
    wsOverview.Range("H1").Value = "Number of Offerings"

    ' Loop through each row in the "All Offerings" sheet
    For i = 2 To lastRow
        ' Get the sector from column X (assuming "Sector" is in column X)
        sector = wsOfferings.Cells(i, 24).Value ' Update the column index if "Sector" is in a different column

        ' Update summary metrics based on the sector
        totalOfferAmt = totalOfferAmt + wsOfferings.Cells(i, 2).Value
        avgDiscount = avgDiscount + wsOfferings.Cells(i, 3).Value
        totalCoupons = totalCoupons + wsOfferings.Cells(i, 17).Value
        numOfferings = numOfferings + 1
    Next i

    ' Output summary metrics to the "Overview" sheet
    wsOverview.Range("D2").Value = sector
    wsOverview.Range("E2").Value = totalOfferAmt
    wsOverview.Range("F2").Value = avgDiscount / numOfferings ' Calculate average discount
    wsOverview.Range("G2").Value = totalCoupons
    wsOverview.Range("H2").Value = numOfferings
End Sub
