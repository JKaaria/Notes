Sub DeleteRowsWithNA()
    Dim wsWorkbook As Workbook
    Dim wsBBI As Worksheet, wsPLC As Worksheet, wsBCIN As Worksheet, wsLNBR As Worksheet
    Dim tbl As ListObject
    Dim lastRow As Long, i As Long

    ' Set workbook and sheets
    Set wsWorkbook = ThisWorkbook
    Set wsBBI = wsWorkbook.Sheets("BBI")
    Set wsPLC = wsWorkbook.Sheets("PLC")
    Set wsBCIN = wsWorkbook.Sheets("BCIN")
    Set wsLNBR = wsWorkbook.Sheets("LNBR")

    ' Loop through each sheet
    For Each ws In Array(wsBBI, wsPLC, wsBCIN, wsLNBR)
        ' Check if the sheet has tables
        If ws.ListObjects.Count > 0 Then
            ' Loop through each table in the sheet
            For Each tbl In ws.ListObjects
                ' Loop through each row in the table
                For i = tbl.ListRows.Count To 1 Step -1
                    ' Check if the first column returns "#N/A" in VLOOKUP value
                    If IsError(Application.VLookup(tbl.ListRows(i).Range.Cells(1, 1).Value, ws.Range("A:B"), 2, False)) Then
                        ' Delete the entire row
                        tbl.ListRows(i).Delete
                    End If
                Next i
            Next tbl
        Else
            ' If the sheet doesn't have tables, loop through each row in the sheet
            lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row
            For i = lastRow To 1 Step -1
                ' Check if the first column returns "#N/A" in VLOOKUP value
                If IsError(Application.VLookup(ws.Cells(i, 1).Value, ws.Range("A:B"), 2, False)) Then
                    ' Delete the entire row
                    ws.Rows(i).Delete
                End If
            Next i
        End If
    Next ws
End Sub

