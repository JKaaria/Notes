Sub ImportDataAndRename()

    ' Define variables
    Dim wsTrade As Worksheet
    Dim wsSource As Worksheet
    Dim sourcePath As String
    Dim sourceFileName As String
    Dim renamedFileName As String
    Dim sourceWorkbook As Workbook
    
    ' Set worksheet
    Set wsTrade = ThisWorkbook.Sheets("TradeData") ' Replace "TradeData" with the actual name of your trade data sheet
    
    ' Clear existing contents in "TradeData" sheet
    wsTrade.Cells.Clear
    
    ' Set source file path to the current workbook's folder
    sourcePath = ThisWorkbook.Path & "\"
    
    ' Find the source file in the current workbook's folder
    sourceFileName = Dir(sourcePath & "sstemp*") ' Update the search pattern as needed
    
    ' Check if a valid source file is found
    If sourceFileName <> "" Then
        ' Create the new name for the source file
        renamedFileName = "SourceFile.xls"
        
        ' Rename the source file
        Name sourcePath & sourceFileName As sourcePath & renamedFileName
        
        ' Open the renamed source workbook
        Set sourceWorkbook = Workbooks.Open(sourcePath & renamedFileName)
        
        ' Set source worksheet
        Set wsSource = sourceWorkbook.Sheets(1) ' Assuming data is in the first sheet of the source workbook
        
        ' Copy data from source worksheet to "TradeData" sheet
        wsSource.UsedRange.Copy wsTrade.Cells(1, 1)
        
        ' Close the source workbook without saving changes
        sourceWorkbook.Close False
        
        MsgBox "Data imported and file renamed successfully!", vbInformation
    Else
        MsgBox "No valid source file found in the current workbook's folder.", vbExclamation
    End If

End Sub

