Sub RemoveNonUSTreasuryWI()
    Dim wsTrade As Worksheet
    Dim lastRow As Long
    Dim issuerAbbrevCol As Integer
    Dim i As Long
    
    ' Set worksheet
    Set wsTrade = ThisWorkbook.Sheets("TradeData")
    
    ' Set column number based on header "Issuer Abbrev"
    issuerAbbrevCol = WorksheetFunction.Match("Issuer Abbrev", wsTrade.Rows(1), 0)
    
    ' Find the last row in the sheet
    lastRow = wsTrade.Cells(wsTrade.Rows.Count, issuerAbbrevCol).End(xlUp).Row
    
    ' Loop through "Issuer Abbrev" column starting from the second row
    For i = lastRow To 2 Step -1
        ' Check if the value does not begin with "US Treasury WI"
        If Left(wsTrade.Cells(i, issuerAbbrevCol).Value, 14) <> "US Treasury WI" Then
            ' If not, remove the row
            wsTrade.Rows(i).Delete
        End If
    Next i
    
    MsgBox "Rows removed successfully!", vbInformation
End Sub

